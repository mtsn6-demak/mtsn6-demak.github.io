<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KimiaCeria: Unsur, Senyawa & Atom</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600&family=Patrick+Hand&display=swap" rel="stylesheet">
    
    <!-- MathJax -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$']], displayMath: [['$$', '$$']] },
            options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'] }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body { 
            font-family: 'Fredoka', sans-serif; 
            background-color: #f0f9ff; 
            color: #1e293b; 
        }
        h1, h2, h3, h4 { 
            font-family: 'Fredoka', cursive; 
            letter-spacing: 0.5px; 
        }
        p, li, td, th, label, input { 
            font-family: 'Patrick Hand', cursive; 
            font-size: 1.15rem; 
        }
        
        .card-hover:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.15); 
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f0f9ff; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 4px; }

        /* Table Styling */
        .materi-table th, .kegiatan-table th { 
            background-color: #dbeafe; 
            color: #1e40af; 
            padding: 12px; 
            border: 2px solid #bfdbfe; 
            font-family: 'Fredoka', cursive; 
        }
        .materi-table td, .kegiatan-table td { 
            padding: 10px; 
            border: 2px solid #e2e8f0; 
            background-color: white; 
            text-align: center; 
        }
        .materi-table td.text-left { text-align: left; }

        /* Quiz Styling */
        .option-label { 
            cursor: pointer; 
            transition: all 0.2s ease; 
            border: 2px solid #cbd5e1; 
        }
        .option-input:checked + .option-content {
            background-color: #eff6ff; 
            border-color: #2563eb; 
            color: #1e3a8a;
        }
        .option-input:checked + .option-content .option-circle {
            background-color: #2563eb; 
            border-color: #2563eb; 
            color: white;
        }

        /* Modal */
        .modal-backdrop { 
            background-color: rgba(15, 23, 42, 0.7); 
            backdrop-filter: blur(4px); 
        }

        /* Kegiatan Checkbox */
        .kegiatan-checkbox {
            width: 1.5rem;
            height: 1.5rem;
            border: 2px solid #3b82f6;
            border-radius: 0.375rem;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            display: inline-block;
            position: relative;
            background-color: white;
        }
        .kegiatan-checkbox:checked {
            background-color: #3b82f6;
        }
        .kegiatan-checkbox:checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 1rem;
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body class="selection:bg-blue-200 selection:text-blue-900">

    <!-- Navigation -->
    <nav class="bg-blue-600 text-white shadow-lg sticky top-0 z-50 border-b-4 border-blue-800">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa-solid fa-shapes text-2xl text-yellow-300 animate-bounce"></i>
                <span class="text-2xl font-semibold tracking-wide">KimiaCeria</span>
            </div>
            <div class="hidden md:flex space-x-6 text-lg">
                <a href="#materi" class="hover:text-yellow-200 transition transform hover:scale-105">Materi</a>
                <a href="#simulasi" class="hover:text-yellow-200 transition transform hover:scale-105">Visualisasi</a>
                <a href="#kegiatan" class="hover:text-yellow-200 transition transform hover:scale-105">Kegiatan Siswa</a>
                <a href="#latihan" class="hover:text-yellow-200 transition transform hover:scale-105">Latihan Soal</a>
            </div>
            <button id="mobile-menu-btn" class="md:hidden bg-blue-700 p-2 rounded-lg">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-blue-700 pb-4 px-4 text-center shadow-inner">
            <a href="#materi" class="block py-2 border-b border-blue-600">Materi</a>
            <a href="#simulasi" class="block py-2 border-b border-blue-600">Visualisasi</a>
            <a href="#kegiatan" class="block py-2 border-b border-blue-600">Kegiatan Siswa</a>
            <a href="#latihan" class="block py-2">Latihan Soal</a>
        </div>
    </nav>

    <!-- Hero -->
    <header class="bg-gradient-to-b from-blue-500 to-sky-100 pt-16 pb-24 px-4 text-center relative overflow-hidden">
        <div class="container mx-auto max-w-4xl relative z-10">
            <span class="bg-white text-blue-600 px-4 py-1 rounded-full text-sm font-bold shadow-sm mb-4 inline-block transform -rotate-1">
                ðŸ“š Rangkuman IPA Kelas 8
            </span>
            <h1 class="text-4xl md:text-6xl font-bold mb-4 text-white drop-shadow-md">
                Unsur, Senyawa & Atom
            </h1>
            <p class="text-lg md:text-xl mb-6 text-blue-900 max-w-2xl mx-auto font-medium bg-white/30 backdrop-blur-sm p-4 rounded-xl">
                "Belajar membedakan unsur logam & non-logam, memahami molekul unsur vs senyawa, serta tabel periodik dengan mudah!"
            </p>
            <a href="#materi" class="bg-indigo-600 text-white border-b-4 border-indigo-800 active:border-b-0 active:translate-y-1 px-8 py-3 rounded-full font-bold text-lg shadow-xl hover:bg-indigo-700 transition inline-flex items-center gap-2">
                <i class="fa-solid fa-book-open"></i> Mulai Belajar
            </a>
        </div>
    </header>

    <!-- Content / Materi Section -->
    <section id="materi" class="py-10 container mx-auto px-4 -mt-16 relative z-20">
        
        <!-- 1. Klasifikasi Unsur -->
        <div class="bg-white p-6 md:p-8 rounded-3xl shadow-lg border-t-8 border-blue-500 mb-8 card-hover">
            <h2 class="text-3xl font-bold text-blue-700 mb-6 flex items-center">
                <span class="bg-blue-100 p-2 rounded-lg mr-3"><i class="fa-solid fa-layer-group"></i></span> 
                1. Klasifikasi & Contoh Unsur
            </h2>
            <p class="mb-4 text-gray-700">
                <b>Unsur</b> adalah zat tunggal yang tidak dapat diuraikan lagi. Berdasarkan sifatnya, unsur dibagi menjadi 3:
            </p>
            
            <div class="grid md:grid-cols-3 gap-6 mt-6">
                <!-- Logam -->
                <div class="bg-blue-50 p-5 rounded-2xl border border-blue-200">
                    <h3 class="text-xl font-bold text-blue-800 mb-2 border-b-2 border-blue-200 pb-1">A. Unsur Logam</h3>
                    <p class="text-sm mb-2 font-bold">Ciri-ciri:</p>
                    <ul class="list-disc pl-4 space-y-1 text-sm text-gray-700 mb-3">
                        <li>Padat (kecuali raksa cair).</li>
                        <li>Putih mengkilap.</li>
                        <li>Konduktor (penghantar listrik/panas).</li>
                        <li>Dapat ditempa/dibentuk.</li>
                    </ul>
                    <div class="text-sm bg-white p-3 rounded-lg shadow-sm">
                        <b>Contoh & Kegunaan:</b>
                        <br>â€¢ <b>Khrom ($Cr$):</b> Bumper mobil (tahan karat).
                        <br>â€¢ <b>Besi ($Fe$):</b> Campuran baja, paling murah.
                        <br>â€¢ <b>Nikel ($Ni$):</b> Tahan udara/air, pelindung.
                        <br>â€¢ <b>Tembaga ($Cu$):</b> Kabel listrik.
                        <br>â€¢ <b>Seng ($Zn$):</b> Atap rumah.
                        <br>â€¢ <b>Platina ($Pt$):</b> Knalpot, kontak listrik.
                        <br>â€¢ <b>Emas ($Au$):</b> Perhiasan.
                    </div>
                </div>

                <!-- Non Logam -->
                <div class="bg-teal-50 p-5 rounded-2xl border border-teal-200">
                    <h3 class="text-xl font-bold text-teal-800 mb-2 border-b-2 border-teal-200 pb-1">B. Unsur Non-Logam</h3>
                    <p class="text-sm mb-2 font-bold">Ciri-ciri:</p>
                    <ul class="list-disc pl-4 space-y-1 text-sm text-gray-700 mb-3">
                        <li>Wujud padat, cair, gas.</li>
                        <li>Kusam, tidak mengkilap.</li>
                        <li>Isolator (tidak menghantar listrik).</li>
                        <li>Rapuh, tidak dapat ditempa.</li>
                    </ul>
                    <div class="text-sm bg-white p-3 rounded-lg shadow-sm">
                        <b>Contoh & Kegunaan:</b>
                        <br>â€¢ <b>Brom ($Br$):</b> Obat penenang saraf.
                        <br>â€¢ <b>Yodium ($I$):</b> Garam dapur, antiseptik luka.
                        <br>â€¢ <b>Fluor ($F$):</b> Pasta gigi (penguat gigi), Freon AC.
                    </div>
                </div>

                <!-- Semi Logam -->
                <div class="bg-orange-50 p-5 rounded-2xl border border-orange-200">
                    <h3 class="text-xl font-bold text-orange-800 mb-2 border-b-2 border-orange-200 pb-1">C. Unsur Semi Logam</h3>
                    <p class="text-sm mb-2 font-bold">Ciri-ciri:</p>
                    <p class="text-sm text-gray-700 mb-3">Disebut <i>Metaloid</i>. Memiliki sifat antara logam dan non-logam (Semikonduktor).</p>
                    <div class="text-sm bg-white p-3 rounded-lg shadow-sm">
                        <b>Contoh:</b>
                        <br>â€¢ <b>Silicon ($Si$) & Germanium ($Ge$):</b> Bahan pembuat chip komputer/elektronik (semikonduktor).
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. Perbedaan Unsur & Atom -->
        <div class="bg-white p-6 md:p-8 rounded-3xl shadow-lg border-t-8 border-indigo-500 mb-8 card-hover">
            <h2 class="text-3xl font-bold text-indigo-700 mb-6 flex items-center">
                <span class="bg-indigo-100 p-2 rounded-lg mr-3"><i class="fa-solid fa-atom"></i></span> 
                2. Perbedaan Unsur dan Atom
            </h2>
            <div class="overflow-x-auto">
                <table class="w-full materi-table text-left border-collapse">
                    <thead>
                        <tr>
                            <th class="w-1/2 text-center">Unsur</th>
                            <th class="w-1/2 text-center">Atom</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Unsur adalah bentuk zat yang paling sederhana. Tidak dapat disederhanakan lagi.</td>
                            <td>Atom adalah bagian dari suatu unsur.</td>
                        </tr>
                        <tr>
                            <td>Unsur tertentu hanya terdiri dari satu jenis atom.</td>
                            <td>Atom selanjutnya tersusun dari partikel subatom (elektron, proton, neutron).</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 3. Tabel Senyawa & Perbedaan -->
        <div class="bg-white p-6 md:p-8 rounded-3xl shadow-lg border-t-8 border-violet-500 mb-8 card-hover">
            <h2 class="text-3xl font-bold text-violet-700 mb-6 flex items-center">
                <span class="bg-violet-100 p-2 rounded-lg mr-3"><i class="fa-solid fa-flask"></i></span> 
                3. Senyawa & Molekul
            </h2>
            
            <div class="flex flex-col md:flex-row gap-8">
                <!-- Tabel Rumus Kimia -->
                <div class="md:w-1/2">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Daftar Rumus Kimia Penting</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full materi-table text-sm border-collapse">
                            <thead>
                                <tr><th>Nama Zat</th><th>Rumus Kimia</th><th>Unsur Penyusun</th></tr>
                            </thead>
                            <tbody>
                                <tr><td class="text-left">Air</td><td>$H_2O$</td><td>Hidrogen, Oksigen</td></tr>
                                <tr><td class="text-left">Garam Dapur</td><td>$NaCl$</td><td>Natrium, Klorin</td></tr>
                                <tr><td class="text-left">Asam Cuka</td><td>$CH_3COOH$</td><td>Karbon, Hidrogen, Oksigen</td></tr>
                                <tr><td class="text-left">Urea</td><td>$CO(NH_2)_2$</td><td>Karbon, Oksigen, Nitrogen, Hidrogen</td></tr>
                                <tr><td class="text-left">Asam Sulfat</td><td>$H_2SO_4$</td><td>Hidrogen, Sulfur, Oksigen</td></tr>
                                <tr><td class="text-left">Glukosa (Gula)</td><td>$C_6H_{12}O_6$</td><td>Karbon, Hidrogen, Oksigen</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Perbedaan Unsur & Senyawa -->
                <div class="md:w-1/2">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Perbedaan Unsur dan Senyawa</h3>
                    <div class="bg-violet-50 p-4 rounded-xl border border-violet-200 h-full">
                        <ul class="space-y-4 text-sm">
                            <li class="flex items-start">
                                <span class="bg-violet-500 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 flex-shrink-0">1</span>
                                <div>
                                    <b>Unsur:</b> Zat tunggal yang tidak bisa diuraikan secara kimia. <br>
                                    <i>Contoh: Besi ($Fe$), Oksigen ($O$).</i>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="bg-violet-500 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 flex-shrink-0">2</span>
                                <div>
                                    <b>Senyawa:</b> Gabungan dua unsur atau lebih melalui reaksi kimia. Sifatnya <b>berbeda</b> dari unsur penyusunnya. <br>
                                    <i>Contoh: Air ($H_2O$) memadamkan api, padahal Hidrogen ($H$) mudah terbakar.</i>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="bg-violet-500 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 flex-shrink-0">3</span>
                                <div>
                                    <b>Molekul Unsur vs Senyawa:</b> <br>
                                    â€¢ Molekul Unsur: Atomnya sejenis ($O_2, Cl_2$). <br>
                                    â€¢ Molekul Senyawa: Atomnya beda jenis ($H_2O, CO_2$).
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. Tabel Periodik & Sifat -->
        <div class="bg-white p-6 md:p-8 rounded-3xl shadow-lg border-t-8 border-sky-500 mb-8 card-hover">
            <h2 class="text-3xl font-bold text-sky-700 mb-6 flex items-center">
                <span class="bg-sky-100 p-2 rounded-lg mr-3"><i class="fa-solid fa-table-cells"></i></span> 
                4. Tabel Periodik & Sifat Keperiodikan
            </h2>
            
            <div class="space-y-6">
                <div class="flex gap-4 flex-wrap">
                    <div class="flex-1 bg-sky-50 p-4 rounded-xl">
                        <h4 class="font-bold text-sky-800 mb-2">Struktur Tabel</h4>
                        <ul class="list-disc pl-4 text-sm space-y-1">
                            <li><b>Periode:</b> Baris Horizontal (Lajur Mendatar).</li>
                            <li><b>Golongan:</b> Kolom Vertikal (Lajur Tegak).</li>
                            <li><b>Golongan VIIIA:</b> Gas Mulia ($He, Ne, Ar, Kr, Xe, Rn$).</li>
                        </ul>
                    </div>
                    <div class="flex-1 bg-sky-50 p-4 rounded-xl">
                        <h4 class="font-bold text-sky-800 mb-2">Sifat Keperiodikan (Kiri ke Kanan)</h4>
                        <ul class="list-disc pl-4 text-sm space-y-1">
                            <li><b>Jari-jari Atom:</b> Semakin Kecil.</li>
                            <li><b>Energi Ionisasi:</b> Semakin Besar (Meningkat).</li>
                            <li><b>Afinitas Elektron:</b> Semakin Besar (Meningkat).</li>
                            <li><b>Elektronegativitas:</b> Semakin Besar.</li>
                            <li><b>Sifat Logam:</b> Berkurang (Makin ke kanan makin Non-Logam).</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Simulation Section -->
    <section id="simulasi" class="bg-blue-50 py-16">
        <div class="container mx-auto px-4">
            <div class="text-center mb-8">
                <span class="inline-block bg-white text-blue-600 px-6 py-2 rounded-full shadow-md font-bold text-sm uppercase mb-3 border border-blue-100">
                    <i class="fa-solid fa-eye mr-2"></i>Visualisasi Konsep
                </span>
                <h2 class="text-3xl font-bold text-gray-800">Partikel Penyusun Atom</h2>
            </div>
            
            <div class="flex flex-col lg:flex-row gap-8 items-center max-w-5xl mx-auto">
                <div class="w-full lg:w-2/3 bg-slate-900 rounded-[2rem] shadow-2xl overflow-hidden relative border-4 border-slate-700">
                    <canvas id="atomCanvas" class="w-full h-[400px] cursor-pointer"></canvas>
                    <div class="absolute bottom-4 left-4 text-white bg-black/50 p-3 rounded-lg backdrop-blur-sm">
                        <p class="text-xs text-gray-300">Model Bohr (Sederhana)</p>
                        <p class="font-bold text-yellow-400" id="atom-name">Hidrogen ($H$)</p>
                    </div>
                </div>
                
                <div class="w-full lg:w-1/3 space-y-4">
                    <div class="bg-white p-4 rounded-2xl shadow border border-blue-100">
                        <label class="block text-sm font-bold text-blue-800 mb-2">Ganti Model Unsur:</label>
                        <select id="element-selector" onchange="changeAtom(this.value)" class="w-full p-2 bg-blue-50 border border-blue-200 rounded-lg text-blue-900 font-bold focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <option value="1">Hidrogen (H)</option>
                            <option value="2">Helium (He)</option>
                            <option value="3">Litium (Li)</option>
                            <option value="6">Karbon (C)</option>
                            <option value="8">Oksigen (O)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Kegiatan Siswa Section -->
    <section id="kegiatan" class="py-16 bg-white">
        <div class="container mx-auto px-4 max-w-4xl">
            <div class="text-center mb-10">
                <span class="inline-block bg-blue-600 text-white px-6 py-2 rounded-full shadow-md font-bold text-sm uppercase mb-3">
                    <i class="fa-solid fa-list-check mr-2"></i>Kegiatan Siswa
                </span>
                <h2 class="text-4xl font-bold text-blue-800">Lembar Kerja Siswa</h2>
                <p class="text-gray-500 mt-2">Lengkapi tabel pengamatan dan identifikasi zat di bawah ini.</p>
            </div>

            <div id="kegiatan-container">

            <!-- 1. Tabel Pengamatan -->
            <div class="bg-white p-6 rounded-3xl shadow-xl border-4 border-blue-50 mb-10">
                <h3 class="text-xl font-bold text-blue-700 mb-4 flex items-center">
                    <span class="bg-blue-100 p-2 rounded-lg mr-3 text-sm"><i class="fa-solid fa-table"></i></span>
                    A. Tabel Pengamatan
                </h3>
                <p class="mb-4 text-sm text-gray-600">Golongkan zat-zat di bawah ini dengan memberikan tanda centang (v).</p>
                <div class="overflow-x-auto">
                    <table class="w-full kegiatan-table border-collapse">
                        <thead>
                            <tr>
                                <th class="w-10">No</th>
                                <th>Zat</th>
                                <th class="w-24">Unsur</th>
                                <th class="w-24">Senyawa</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td class="text-left pl-4">Gula</td><td><input type="radio" name="kegA_1" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_1" value="senyawa" class="kegiatan-checkbox"></td></tr>
                            <tr><td>2</td><td class="text-left pl-4">Air</td><td><input type="radio" name="kegA_2" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_2" value="senyawa" class="kegiatan-checkbox"></td></tr>
                            <tr><td>3</td><td class="text-left pl-4">Seng</td><td><input type="radio" name="kegA_3" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_3" value="senyawa" class="kegiatan-checkbox"></td></tr>
                            <tr><td>4</td><td class="text-left pl-4">Garam dapur</td><td><input type="radio" name="kegA_4" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_4" value="senyawa" class="kegiatan-checkbox"></td></tr>
                            <tr><td>5</td><td class="text-left pl-4">Besi</td><td><input type="radio" name="kegA_5" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_5" value="senyawa" class="kegiatan-checkbox"></td></tr>
                            <tr><td>6</td><td class="text-left pl-4">Sabun</td><td><input type="radio" name="kegA_6" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_6" value="senyawa" class="kegiatan-checkbox"></td></tr>
                            <tr><td>7</td><td class="text-left pl-4">Tembaga</td><td><input type="radio" name="kegA_7" value="unsur" class="kegiatan-checkbox"></td><td><input type="radio" name="kegA_7" value="senyawa" class="kegiatan-checkbox"></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 2. Identifikasi Gambar -->
            <div class="bg-white p-6 rounded-3xl shadow-xl border-4 border-blue-50 mb-10">
                <h3 class="text-xl font-bold text-blue-700 mb-4 flex items-center">
                    <span class="bg-blue-100 p-2 rounded-lg mr-3 text-sm"><i class="fa-solid fa-images"></i></span>
                    B. Identifikasi Zat Berdasarkan Gambar
                </h3>
                <p class="mb-4 text-sm text-gray-600">Golongkan zat-zat berikut termasuk unsur, senyawa, atau campuran.</p>
                <div class="overflow-x-auto">
                    <table class="w-full kegiatan-table border-collapse">
                        <thead>
                            <tr>
                                <th class="w-1/3">Gambar Zat</th>
                                <th>Unsur</th>
                                <th>Senyawa</th>
                                <th>Campuran</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Emas Batangan -->
                            <tr>
                                <td class="text-center py-4">
                                    <div class="w-32 h-24 mx-auto mb-2 flex items-center justify-center">
                                        <svg viewBox="0 0 100 60" class="w-full h-full drop-shadow-md">
                                            <defs>
                                                <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                                    <stop offset="0%" style="stop-color:#fef08a;stop-opacity:1" />
                                                    <stop offset="50%" style="stop-color:#fbbf24;stop-opacity:1" />
                                                    <stop offset="100%" style="stop-color:#b45309;stop-opacity:1" />
                                                </linearGradient>
                                            </defs>
                                            <path d="M10,40 L40,40 L50,25 L20,25 Z" fill="url(#goldGrad)" stroke="#b45309"/>
                                            <path d="M10,40 L10,50 L40,50 L40,40 Z" fill="#d97706" stroke="#b45309"/>
                                            <path d="M40,50 L50,35 L50,25 L40,40 Z" fill="#b45309" stroke="#b45309"/>
                                            <path d="M30,30 L60,30 L70,15 L40,15 Z" fill="url(#goldGrad)" stroke="#b45309"/>
                                            <path d="M30,30 L30,40 L60,40 L60,30 Z" fill="#d97706" stroke="#b45309"/>
                                            <path d="M60,40 L70,25 L70,15 L60,30 Z" fill="#b45309" stroke="#b45309"/>
                                            <text x="35" y="58" font-size="10" text-anchor="middle" fill="#78350f" font-weight="bold">99.9% GOLD</text>
                                        </svg>
                                    </div>
                                    <p class="font-bold text-slate-700">Emas</p>
                                </td>
                                <td><input type="radio" name="kegB_1" value="unsur" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_1" value="senyawa" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_1" value="campuran" class="kegiatan-checkbox"></td>
                            </tr>
                            
                            <!-- Air Murni -->
                            <tr>
                                <td class="text-center py-4">
                                    <div class="w-24 h-24 mx-auto mb-2 flex items-center justify-center">
                                        <svg viewBox="0 0 60 80" class="w-full h-full drop-shadow-sm">
                                            <path d="M30,5 Q5,35 5,55 A25,25 0 1,0 55,55 Q55,35 30,5 Z" fill="#3b82f6" stroke="#1d4ed8" fill-opacity="0.8"/>
                                            <path d="M40,25 Q35,20 30,25" fill="none" stroke="white" stroke-width="2" opacity="0.6"/>
                                        </svg>
                                    </div>
                                    <p class="font-bold text-slate-700">Air</p>
                                </td>
                                <td><input type="radio" name="kegB_2" value="unsur" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_2" value="senyawa" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_2" value="campuran" class="kegiatan-checkbox"></td>
                            </tr>

                            <!-- Kapur Murni -->
                            <tr>
                                <td class="text-center py-4">
                                    <div class="w-24 h-24 mx-auto mb-2 flex items-center justify-center">
                                        <svg viewBox="0 0 80 60" class="w-full h-full">
                                            <path d="M10,40 Q20,30 40,35 Q60,30 70,45 Q65,55 40,55 Q15,55 10,40 Z" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2"/>
                                            <path d="M20,20 Q30,10 50,15 Q70,20 60,35 Q40,30 20,35 Q10,30 20,20 Z" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2"/>
                                        </svg>
                                    </div>
                                    <p class="font-bold text-slate-700">Kapur</p>
                                </td>
                                <td><input type="radio" name="kegB_3" value="unsur" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_3" value="senyawa" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_3" value="campuran" class="kegiatan-checkbox"></td>
                            </tr>

                            <!-- Gula Pasir -->
                            <tr>
                                <td class="text-center py-4">
                                    <div class="w-28 h-24 mx-auto mb-2 flex items-center justify-center">
                                        <svg viewBox="0 0 100 80" class="w-full h-full drop-shadow-md">
                                            <path d="M20,20 Q20,10 30,10 L70,10 Q80,10 80,20 L85,70 Q85,80 75,80 L25,80 Q15,80 15,70 Z" fill="#f8fafc" stroke="#94a3b8" stroke-width="2"/>
                                            <rect x="30" y="30" width="40" height="25" rx="5" fill="#e2e8f0"/>
                                            <text x="50" y="45" text-anchor="middle" font-size="10" font-weight="bold" fill="#475569">GULA</text>
                                            <text x="50" y="55" text-anchor="middle" font-size="8" font-weight="bold" fill="#475569">PASIR</text>
                                            <circle cx="25" cy="65" r="1" fill="#cbd5e1"/><circle cx="35" cy="70" r="1" fill="#cbd5e1"/><circle cx="75" cy="60" r="1" fill="#cbd5e1"/>
                                        </svg>
                                    </div>
                                    <p class="font-bold text-slate-700">Gula Pasir</p>
                                </td>
                                <td><input type="radio" name="kegB_4" value="unsur" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_4" value="senyawa" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_4" value="campuran" class="kegiatan-checkbox"></td>
                            </tr>

                            <!-- Garam Gurih -->
                            <tr>
                                <td class="text-center py-4">
                                    <div class="w-28 h-24 mx-auto mb-2 flex items-center justify-center">
                                        <svg viewBox="0 0 100 80" class="w-full h-full drop-shadow-md">
                                            <rect x="25" y="15" width="50" height="60" rx="2" fill="#e2e8f0" stroke="#64748b" stroke-width="2"/>
                                            <rect x="25" y="15" width="50" height="10" fill="#94a3b8" stroke="#64748b"/>
                                            <circle cx="50" cy="45" r="18" fill="white" stroke="#94a3b8"/>
                                            <text x="50" y="48" text-anchor="middle" font-size="8" font-weight="bold" fill="#1e293b">GARAM</text>
                                            <text x="50" y="58" text-anchor="middle" font-size="6" font-weight="bold" fill="#ef4444">GURIH</text>
                                        </svg>
                                    </div>
                                    <p class="font-bold text-slate-700">Garam Gurih</p>
                                </td>
                                <td><input type="radio" name="kegB_5" value="unsur" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_5" value="senyawa" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_5" value="campuran" class="kegiatan-checkbox"></td>
                            </tr>

                            <!-- Cuka Apel -->
                            <tr>
                                <td class="text-center py-4">
                                    <div class="w-24 h-24 mx-auto mb-2 flex items-center justify-center">
                                        <svg viewBox="0 0 60 100" class="w-full h-full drop-shadow-md">
                                            <rect x="25" y="5" width="10" height="20" fill="#78350f" stroke="#451a03"/>
                                            <path d="M20,25 L40,25 L50,40 L50,90 Q50,95 45,95 L15,95 Q10,95 10,90 L10,40 Z" fill="#92400e" stroke="#451a03" stroke-width="2"/>
                                            <rect x="15" y="50" width="30" height="30" rx="2" fill="#fef3c7" stroke="#d97706"/>
                                            <text x="30" y="65" text-anchor="middle" font-size="8" font-weight="bold" fill="#78350f">CUKA</text>
                                            <text x="30" y="75" text-anchor="middle" font-size="8" font-weight="bold" fill="#78350f">APEL</text>
                                        </svg>
                                    </div>
                                    <p class="font-bold text-slate-700">Cuka Apel</p>
                                </td>
                                <td><input type="radio" name="kegB_6" value="unsur" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_6" value="senyawa" class="kegiatan-checkbox"></td>
                                <td><input type="radio" name="kegB_6" value="campuran" class="kegiatan-checkbox"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 3. Komposisi Unsur dalam Senyawa -->
            <div class="bg-white p-6 rounded-3xl shadow-xl border-4 border-blue-50 mb-10">
                <h3 class="text-xl font-bold text-blue-700 mb-4 flex items-center">
                    <span class="bg-blue-100 p-2 rounded-lg mr-3 text-sm"><i class="fa-solid fa-puzzle-piece"></i></span>
                    C. Komposisi Unsur dalam Senyawa
                </h3>
                <p class="mb-4 text-sm text-gray-600">Pilihlah jawaban yang tepat untuk mengisi kolom yang kosong melalui menu <i>dropdown</i>.</p>
                <div class="overflow-x-auto">
                    <table class="w-full kegiatan-table border-collapse">
                        <thead>
                            <tr class="text-sm">
                                <th class="w-1/4">Nama Zat</th>
                                <th class="w-1/4">Rumus Kimia</th>
                                <th class="w-1/4">Terdiri dari Unsur dgn Lambang</th>
                                <th class="w-1/4">Nama Unsur</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm">
                            <!-- Air -->
                            <tr>
                                <td class="font-bold text-left pl-4 text-slate-700">Air</td>
                                <td>
                                    <select name="kegC_1" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer font-['Fredoka'] text-base">
                                        <option value="">- Pilih -</option>
                                        <option value="H2O">Hâ‚‚O</option>
                                        <option value="HO">HO</option>
                                        <option value="H2O2">Hâ‚‚Oâ‚‚</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_2" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="1H2O">1 H, 2 O</option>
                                        <option value="2H1O">2 H, 1 O</option>
                                        <option value="2H2O">2 H, 2 O</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_3" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="Helium_Oksigen">Helium, Oksigen</option>
                                        <option value="Klorin_Oksigen">Klorin, Oksigen</option>
                                        <option value="Hidrogen_Oksigen">Hidrogen, Oksigen</option>
                                    </select>
                                </td>
                            </tr>
                            <!-- Garam dapur -->
                            <tr>
                                <td class="font-bold text-left pl-4 text-slate-700">Garam dapur</td>
                                <td>
                                    <select name="kegC_4" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer font-['Fredoka'] text-base">
                                        <option value="">- Pilih -</option>
                                        <option value="NaOH">NaOH</option>
                                        <option value="NaCl">NaCl</option>
                                        <option value="HCl">HCl</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_5" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="1Na1Cl">1 Na, 1 Cl</option>
                                        <option value="1Na2Cl">1 Na, 2 Cl</option>
                                        <option value="2Na1Cl">2 Na, 1 Cl</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_6" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="Natrium_Karbon">Natrium, Karbon</option>
                                        <option value="Nitrogen_Klorin">Nitrogen, Klorin</option>
                                        <option value="Natrium_Klorin">Natrium, Klorin</option>
                                    </select>
                                </td>
                            </tr>
                            <!-- Asam sulfat -->
                            <tr>
                                <td class="font-bold text-left pl-4 text-slate-700">Asam sulfat</td>
                                <td>
                                    <select name="kegC_7" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer font-['Fredoka'] text-base">
                                        <option value="">- Pilih -</option>
                                        <option value="H2S">Hâ‚‚S</option>
                                        <option value="HSO3">HSOâ‚ƒ</option>
                                        <option value="H2SO4">Hâ‚‚SOâ‚„</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_8" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="2H1S4O">2 H, 1 S, 4 O</option>
                                        <option value="1H2S4O">1 H, 2 S, 4 O</option>
                                        <option value="2H4S1O">2 H, 4 S, 1 O</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_9" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="Hidrogen_Sulfur_Oksigen">Hidrogen, Sulfur, Oksigen</option>
                                        <option value="Hidrogen_Sulfur_Karbon">Hidrogen, Sulfur, Karbon</option>
                                        <option value="Helium_Sulfur_Oksigen">Helium, Sulfur, Oksigen</option>
                                    </select>
                                </td>
                            </tr>
                            <!-- Asam cuka -->
                            <tr>
                                <td class="font-bold text-left pl-4 text-slate-700">Asam cuka</td>
                                <td>
                                    <select name="kegC_10" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer font-['Fredoka'] text-base">
                                        <option value="">- Pilih -</option>
                                        <option value="CH4">CHâ‚„</option>
                                        <option value="CH3COOH">CHâ‚ƒCOOH</option>
                                        <option value="C2H5OH">Câ‚‚Hâ‚…OH</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_11" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="1C2O3H">1 C, 2 O, 3 H</option>
                                        <option value="2C2O4H">2 C, 2 O, 4 H</option>
                                        <option value="2C1O4H">2 C, 1 O, 4 H</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_12" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="Karbon_Oksigen_Hidrogen">Karbon, Oksigen, Hidrogen</option>
                                        <option value="Kalsium_Oksigen_Hidrogen">Kalsium, Oksigen, Hidrogen</option>
                                        <option value="Kalium_Oksigen_Hidrogen">Kalium, Oksigen, Hidrogen</option>
                                    </select>
                                </td>
                            </tr>
                            <!-- Natrium hidroksida -->
                            <tr>
                                <td class="font-bold text-left pl-4 text-slate-700">Natrium hidroksida</td>
                                <td>
                                    <select name="kegC_13" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer font-['Fredoka'] text-base">
                                        <option value="">- Pilih -</option>
                                        <option value="Na2O">Naâ‚‚O</option>
                                        <option value="NaCl">NaCl</option>
                                        <option value="NaOH">NaOH</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_14" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="2Na1O1H">2 Na, 1 O, 1 H</option>
                                        <option value="1Na1O1H">1 Na, 1 O, 1 H</option>
                                        <option value="1Na2O1H">1 Na, 2 O, 1 H</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="kegC_15" class="w-full p-2 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 cursor-pointer">
                                        <option value="">- Pilih Jawaban -</option>
                                        <option value="Nitrogen_Oksigen_Hidrogen">Nitrogen, Oksigen, Hidrogen</option>
                                        <option value="Natrium_Oksigen_Hidrogen">Natrium, Oksigen, Hidrogen</option>
                                        <option value="Neon_Oksigen_Hidrogen">Neon, Oksigen, Hidrogen</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Submit Button for Kegiatan -->
            <div class="text-center pt-4 pb-10">
                <button type="button" id="btn-kirim-kegiatan" onclick="preSubmitKegiatanCheck()" class="bg-green-600 hover:bg-green-700 text-white text-xl font-bold px-12 py-4 rounded-full shadow-lg border-b-4 border-green-800 active:border-b-0 active:translate-y-1 transition transform hover:scale-105">
                    Kirim Lembar Kerja
                </button>
            </div>
            </div> <!-- End of kegiatan-container -->
        </div>
    </section>

    <!-- Quiz Section -->
    <section id="latihan" class="py-16 bg-blue-50">
        <div class="container mx-auto px-4 max-w-3xl">
            <div class="text-center mb-10">
                <span class="inline-block bg-blue-600 text-white px-6 py-2 rounded-full shadow-md font-bold text-sm uppercase mb-3">
                    <i class="fa-solid fa-pen-nib mr-2"></i>Evaluasi
                </span>
                <h2 class="text-4xl font-bold text-blue-800">Latihan Soal</h2>
            </div>
            
            <div id="quiz-login" class="bg-white rounded-3xl shadow-xl p-8 border-4 border-blue-50 relative overflow-hidden">
                <div class="space-y-4">
                    <input type="text" id="student-name" class="w-full p-4 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 transition" placeholder="Nama Lengkap">
                    <input type="text" id="student-class" class="w-full p-4 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 transition" placeholder="Kelas">
                    <button onclick="startQuiz()" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-blue-700 transition transform active:scale-95">Mulai Mengerjakan</button>
                </div>
            </div>
            
            <div id="quiz-container" class="hidden space-y-8">
                <div class="flex justify-between items-center bg-white px-5 py-3 rounded-xl border border-blue-100 shadow-sm">
                    <div class="font-bold text-blue-800">
                        <i class="fa-solid fa-id-badge mr-2"></i> 
                        <span id="display-name">Siswa</span>
                    </div>
                    <div class="text-sm font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-full shadow-sm">
                        Total: 10 Soal
                    </div>
                </div>
                
                <form id="quiz-form" class="space-y-6"></form>
                
                <div class="text-center pt-4">
                    <button type="button" onclick="preSubmitCheck()" class="bg-green-600 hover:bg-green-700 text-white text-xl font-bold px-12 py-4 rounded-full shadow-lg border-b-4 border-green-800 active:border-b-0 active:translate-y-1 transition transform hover:scale-105">
                        Kirim Jawaban
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal -->
    <div id="custom-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop px-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-sm w-full relative flex flex-col items-center text-center animate-[popIn_0.3s_ease-out]">
            <div id="modal-icon" class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center text-3xl mb-4 text-blue-600 shadow-inner"></div>
            <h3 id="modal-title" class="text-2xl font-bold mb-2 text-slate-800 font-['Fredoka']"></h3>
            <div id="modal-body" class="text-slate-600 mb-6 text-lg font-['Patrick_Hand']"></div>
            <div id="modal-actions" class="flex gap-3 w-full"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // Menggunakan konfigurasi Firebase dari dashboard Rekap Nilai agar terhubung
        const firebaseConfig = {
            apiKey: "AIzaSyAkX8qAS-O_5m_qaGr8Aa9XME-lVyBMibw",
            authDomain: "belajaronline-b5512.firebaseapp.com",
            projectId: "belajaronline-b5512",
            storageBucket: "belajaronline-b5512.firebasestorage.app",
            messagingSenderId: "896107581081",
            appId: "1:896107581081:web:629056c097c90fdf583208",
            measurementId: "G-7MKNGF9PCX"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = 'belajaronline-b5512'; // Sesuai dengan web Rekap Nilai

        let currentUser = null;

        const initAuth = async () => {
            try {
                // Login anonim langsung ke database Rekap Nilai
                await signInAnonymously(auth);
            } catch (err) { 
                console.error("Auth error", err); 
            }
        };

        initAuth();
        onAuthStateChanged(auth, user => currentUser = user);

        // --- ATOM VISUALIZATION ---
        const canvas = document.getElementById('atomCanvas');
        const ctx = canvas.getContext('2d');
        let currentProtons = 1;
        let angle = 0;

        function resizeCanvas() {
            if(canvas.parentElement) {
                canvas.width = canvas.parentElement.offsetWidth;
                canvas.height = canvas.parentElement.offsetHeight;
            }
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        window.changeAtom = (val) => {
            currentProtons = parseInt(val);
            const names = {
                1: "Hidrogen (H)", 
                2: "Helium (He)", 
                3: "Litium (Li)", 
                6: "Karbon (C)", 
                8: "Oksigen (O)"
            };
            document.getElementById('atom-name').textContent = names[currentProtons];
        };

        function drawAtom() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;

            // Draw Nucleus
            for(let i = 0; i < currentProtons * 2; i++){
                ctx.beginPath();
                const ox = Math.cos(i * 13) * 10; 
                const oy = Math.sin(i * 13) * 10;
                ctx.arc(cx + ox, cy + oy, 6, 0, Math.PI * 2);
                ctx.fillStyle = i % 2 === 0 ? '#ef4444' : '#facc15';
                ctx.fill();
            }

            // Draw Electron Shells
            const shells = [
                {r: 60, n: Math.min(currentProtons, 2)}, 
                {r: 110, n: Math.max(0, Math.min(currentProtons - 2, 8))}
            ];
            
            angle += 0.02;
            
            shells.forEach((shell, idx) => {
                if(shell.n > 0){
                    ctx.beginPath();
                    ctx.arc(cx, cy, shell.r, 0, Math.PI * 2);
                    ctx.strokeStyle = 'rgba(255,255,255,0.2)';
                    ctx.stroke();
                    
                    for(let j = 0; j < shell.n; j++){
                        const theta = angle * (idx + 1) + (j * (Math.PI * 2 / shell.n));
                        ctx.beginPath();
                        ctx.arc(cx + Math.cos(theta) * shell.r, cy + Math.sin(theta) * shell.r, 6, 0, Math.PI * 2);
                        ctx.fillStyle = '#60a5fa';
                        ctx.fill();
                    }
                }
            });
            requestAnimationFrame(drawAtom);
        }
        drawAtom();

        // --- SVG ASSETS FOR QUIZ ---
        const svgs = {
            defs: `
                <defs>
                    <radialGradient id="grad-grey" cx="30%" cy="30%" r="70%">
                        <stop offset="0%" style="stop-color:#94a3b8;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#475569;stop-opacity:1" />
                    </radialGradient>
                    <radialGradient id="grad-light" cx="30%" cy="30%" r="70%">
                        <stop offset="0%" style="stop-color:#f1f5f9;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#cbd5e1;stop-opacity:1" />
                    </radialGradient>
                    <radialGradient id="grad-dark" cx="30%" cy="30%" r="70%">
                        <stop offset="0%" style="stop-color:#475569;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
                    </radialGradient>
                </defs>
            `,
            q9_1: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="35" cy="30" r="18" fill="url(#grad-grey)" stroke="#334155" stroke-width="1"/><circle cx="65" cy="30" r="18" fill="url(#grad-grey)" stroke="#334155" stroke-width="1"/><text x="50" y="55" font-size="10" text-anchor="middle" fill="#64748b">klorin (Clâ‚‚)</text></svg>`,
            q9_2: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="35" cy="30" r="18" fill="url(#grad-grey)" stroke="#334155" stroke-width="1"/><circle cx="65" cy="30" r="18" fill="url(#grad-grey)" stroke="#334155" stroke-width="1"/><text x="50" y="55" font-size="10" text-anchor="middle" fill="#64748b">oksigen (Oâ‚‚)</text></svg>`,
            q9_3: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="30" cy="30" r="12" fill="url(#grad-light)" stroke="#94a3b8" stroke-width="1"/><circle cx="60" cy="30" r="20" fill="url(#grad-dark)" stroke="#1e293b" stroke-width="1"/><text x="50" y="58" font-size="10" text-anchor="middle" fill="#64748b">asam klorida (HCl)</text></svg>`,
            q9_4: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="30" cy="40" r="15" fill="url(#grad-grey)" stroke="#334155"/><circle cx="70" cy="40" r="15" fill="url(#grad-grey)" stroke="#334155"/><circle cx="50" cy="20" r="15" fill="url(#grad-grey)" stroke="#334155"/><text x="50" y="58" font-size="10" text-anchor="middle" fill="#64748b">ozon (Oâ‚ƒ)</text></svg>`,
            
            q10_1: `<svg viewBox="0 0 100 60" class="w-20 h-16"><g fill="white" stroke="black" stroke-width="1.5"><circle cx="35" cy="30" r="15"/><circle cx="65" cy="30" r="15"/></g><text x="35" y="34" text-anchor="middle" font-size="12" font-weight="bold">N</text><text x="65" y="34" text-anchor="middle" font-size="12" font-weight="bold">N</text></svg>`,
            q10_2: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="50" cy="30" r="15" fill="white" stroke="black" stroke-width="1.5"/><circle cx="30" cy="45" r="10" fill="white" stroke="black" stroke-width="1.5"/><circle cx="70" cy="45" r="10" fill="white" stroke="black" stroke-width="1.5"/><text x="50" y="34" text-anchor="middle" font-size="12" font-weight="bold">O</text><text x="30" y="49" text-anchor="middle" font-size="10" font-weight="bold">H</text><text x="70" y="49" text-anchor="middle" font-size="10" font-weight="bold">H</text></svg>`,
            q10_3: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="50" cy="15" r="12" fill="white" stroke="black"/><circle cx="30" cy="35" r="12" fill="white" stroke="black"/><circle cx="70" cy="35" r="12" fill="white" stroke="black"/><circle cx="50" cy="50" r="12" fill="white" stroke="black"/><text x="50" y="19" text-anchor="middle" font-size="10" font-weight="bold">P</text><text x="30" y="39" text-anchor="middle" font-size="10" font-weight="bold">P</text><text x="70" y="39" text-anchor="middle" font-size="10" font-weight="bold">P</text><text x="50" y="54" text-anchor="middle" font-size="10" font-weight="bold">P</text></svg>`,
            q10_4: `<svg viewBox="0 0 100 60" class="w-20 h-16"><circle cx="50" cy="25" r="15" fill="white" stroke="black" stroke-width="1.5"/><circle cx="30" cy="45" r="10" fill="white" stroke="black"/><circle cx="70" cy="45" r="10" fill="white" stroke="black"/><circle cx="50" cy="55" r="10" fill="white" stroke="black"/><text x="50" y="29" text-anchor="middle" font-size="12" font-weight="bold">N</text><text x="30" y="49" text-anchor="middle" font-size="10" font-weight="bold">H</text><text x="70" y="49" text-anchor="middle" font-size="10" font-weight="bold">H</text><text x="50" y="59" text-anchor="middle" font-size="10" font-weight="bold">H</text></svg>`,
        };

        const svgBox = (num, content) => `
            <div class="flex flex-col items-center">
                <div class="mb-1">${svgs.defs + content}</div>
                <span class="text-sm font-bold text-gray-600">${num}</span>
            </div>
        `;

        const quizData = [
            {
                q: "Perhatikan pernyataan berikut ini!<br> (1) sifat senyawa tidak sama dengan unsur penyusunnya<br> (2) unsur dapat dibagi lagi menjadi bagian yang lebih sederhana dengan reaksi kimia biasa<br> (3) senyawa tersusun atas satu jenis unsur<br> (4) unsur-unsur tidak dapat membentuk senyawa melalui reaksi kimia<br> Diantara pernyataan di atas yang tepat adalah ....",
                options: ["(1)", "(2)", "(3)", "(4)"],
                a: 0
            },
            {
                q: "Zat tunggal yang dapat diuraikan menjadi dua zat atau lebih melalui reaksi kimia biasa disebut...",
                options: ["unsur", "atom", "senyawa", "molekul"],
                a: 2
            },
            {
                q: "Perhatikan ciri-ciri di bawah ini!<br> 1. Ada yang berwujud padat, cair, dan gas.<br> 2. Bersifat rapuh dan tidak dapat ditempa.<br> 3. Nonkonduktor, kecuali grafit.<br> Pernyataan di atas merupakan ciri dari .....",
                options: ["larutan", "senyawa", "unsur logam", "unsur nonlogam"],
                a: 3
            },
            {
                q: "Berikut ini yang merupakan senyawa adalah.....",
                options: ["$Au$, $F$", "$Cl$, $Na$", "$H_2O$, $NaCl$", "$Mg$, $CH_3COOH$"],
                a: 2
            },
            {
                q: "Unsur-unsur yang termasuk kedalam golongan VIIIA adalah ....",
                options: ["$He, Ne, Ar, Kr, Xe, Rn$", "$H, Li, K, Rb, Cs, Fr$", "$Be, Mg, Ca, Sr, Ba, Ra$", "$N, P, As, Sb, Bi$"],
                a: 0
            },
            {
                q: "Zat tunggal yang tidak dapat dibagi lagi menjadi bagian yang lebih sederhana dan akan tetap mempertahankan karakteristik asli dari unsur tersebut merupakan pengertian dari ....",
                options: ["senyawa", "unsur", "campuran", "larutan"],
                a: 1
            },
            {
                q: "Setiap molekul urea mengandung 1 atom karbon, 1 atom oksigen, 2 atom nitrogen, dan 4 atom hidrogen, maka penulisan rumus kimia urea adalah.....",
                options: ["$CONH_2$", "$CO_2NH$", "$((CO)_2NH)_2$", "$CO(NH_2)_2$"],
                a: 3
            },
            {
                q: "Berikut merupakan unsur-unsur yang memiliki wujud padat adalah ....",
                options: ["$C, Ca$ dan $H$", "$Au, P$ dan $He$", "$Fe, Au,$ dan $C$", "$Fe, Au$ dan $N$"],
                a: 2
            },
            {
                q: `Perhatikan gambar di bawah ini!<br>
                <div class="grid grid-cols-4 gap-2 mt-2 bg-white p-3 rounded-lg border border-gray-200">
                    ${svgBox("1", svgs.q9_1)}
                    ${svgBox("2", svgs.q9_2)}
                    ${svgBox("3", svgs.q9_3)}
                    ${svgBox("4", svgs.q9_4)}
                </div>
                Yang termasuk kedalam molekul unsur adalah gambar nomor....`,
                options: ["1", "2", "3", "4"],
                a: 1 
            },
            {
                q: `Perhatikan gambar di bawah ini!<br>
                <div class="grid grid-cols-4 gap-2 mt-2 bg-white p-3 rounded-lg border border-gray-200">
                    ${svgBox("1", svgs.q10_1)}
                    ${svgBox("2", svgs.q10_2)}
                    ${svgBox("3", svgs.q10_3)}
                    ${svgBox("4", svgs.q10_4)}
                </div>
                Di antara gambar di atas yang merupakan molekul senyawa adalah ....`,
                options: ["1 dan 2", "1 dan 3", "2 dan 4", "3 dan 4"],
                a: 2 
            }
        ];

        // Kegiatan Logic
        window.preSubmitKegiatanCheck = () => {
            let answered = 0;
            const total = 28; // 7(A) + 6(B) + 15(C)
            for(let i=1; i<=7; i++) if(document.querySelector(`input[name="kegA_${i}"]:checked`)) answered++;
            for(let i=1; i<=6; i++) if(document.querySelector(`input[name="kegB_${i}"]:checked`)) answered++;
            for(let i=1; i<=15; i++) if(document.querySelector(`select[name="kegC_${i}"]`).value !== "") answered++;
            
            if(answered < total) {
                showModal({
                    title: "Belum Selesai", 
                    message: `Baru dikerjakan ${answered} dari ${total} pertanyaan.`, 
                    buttons: [
                        {text: "Lanjut Mengerjakan"}, 
                        {text: "Kirim Tetap", action: promptKegiatanIdentity}
                    ]
                });
            } else {
                promptKegiatanIdentity();
            }
        };

        window.promptKegiatanIdentity = () => {
            showModal({
                title: "Data Diri Pengamat",
                message: `
                    <p class="mb-4 text-sm text-slate-500">Silakan isi nama dan kelas Anda untuk menyimpan nilai pengamatan.</p>
                    <input type="text" id="popup-name" class="w-full p-4 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 transition mb-3" placeholder="Nama Lengkap">
                    <input type="text" id="popup-class" class="w-full p-4 border-2 border-slate-200 rounded-xl outline-none focus:border-blue-500 bg-slate-50 transition" placeholder="Kelas">
                    <p id="popup-error" class="text-red-500 text-sm mt-3 hidden font-bold animate-pulse"><i class="fa-solid fa-circle-exclamation mr-1"></i> Nama dan Kelas wajib diisi!</p>
                `,
                icon: '<i class="fa-solid fa-user-graduate text-blue-500"></i>',
                buttons: [
                    {text: "Batal"},
                    {text: "Simpan & Lihat Nilai", action: validateAndSubmitKegiatan}
                ]
            });
        };

        window.validateAndSubmitKegiatan = () => {
            const name = document.getElementById('popup-name').value.trim();
            const cls = document.getElementById('popup-class').value.trim();

            if (!name || !cls) {
                document.getElementById('popup-error').classList.remove('hidden');
                return;
            }

            submitKegiatan(name, cls);
        };

        async function submitKegiatan(name, cls) {
            showModal({
                title: "Mengirim...", 
                message: "Menyimpan nilai pengamatan Anda...", 
                icon: '<i class="fa-solid fa-spinner fa-spin"></i>', 
                buttons: []
            });
            
            // Kunci Jawaban (Telah disesuaikan agar tidak mengecoh siswa kelas 8)
            const answersA = {
                kegA_1: 'senyawa', // Gula
                kegA_2: 'senyawa', // Air
                kegA_3: 'unsur',   // Seng
                kegA_4: 'senyawa', // Garam Dapur
                kegA_5: 'unsur',   // Besi
                kegA_6: 'senyawa', // Sabun
                kegA_7: 'unsur'    // Tembaga
            };
            const answersB = {
                kegB_1: 'unsur',    // Emas
                kegB_2: 'senyawa',  // Air Murni
                kegB_3: 'senyawa',  // Kapur Murni
                kegB_4: 'senyawa',  // Gula Pasir
                kegB_5: 'senyawa',  // Garam Gurih (Dianggap sebagai Senyawa Garam/MSG)
                kegB_6: 'senyawa'   // Cuka Apel (Dianggap sebagai Senyawa Asam Cuka)
            };
            const answersC = {
                kegC_1: 'H2O',
                kegC_2: '2H1O',
                kegC_3: 'Hidrogen_Oksigen',
                kegC_4: 'NaCl',
                kegC_5: '1Na1Cl',
                kegC_6: 'Natrium_Klorin',
                kegC_7: 'H2SO4',
                kegC_8: '2H1S4O',
                kegC_9: 'Hidrogen_Sulfur_Oksigen',
                kegC_10: 'CH3COOH',
                kegC_11: '2C2O4H',
                kegC_12: 'Karbon_Oksigen_Hidrogen',
                kegC_13: 'NaOH',
                kegC_14: '1Na1O1H',
                kegC_15: 'Natrium_Oksigen_Hidrogen'
            };

            let correct = 0;
            let total = Object.keys(answersA).length + Object.keys(answersB).length + Object.keys(answersC).length;

            for(let key in answersA) {
                const sel = document.querySelector(`input[name="${key}"]:checked`);
                if(sel && sel.value === answersA[key]) correct++;
            }
            for(let key in answersB) {
                const sel = document.querySelector(`input[name="${key}"]:checked`);
                if(sel && sel.value === answersB[key]) correct++;
            }
            for(let key in answersC) {
                const sel = document.querySelector(`select[name="${key}"]`);
                if(sel && sel.value === answersC[key]) correct++;
            }
            
            const score = Math.round((correct / total) * 100);
            
            try {
                if(!currentUser) await signInAnonymously(auth);
                
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'scores'), {
                    name: name, 
                    kelas: cls, 
                    score: score,
                    materi: 'Lembar Kerja Kimia', 
                    date: new Date().toLocaleDateString('id-ID'),
                    timestamp: Date.now()
                });
                
                hideModal();
                showModal({
                    title: "Selesai!", 
                    message: `Luar Biasa! Nilai Lembar Kerja Anda: <strong>${score}</strong>`, 
                    icon: '<i class="fa-solid fa-medal text-yellow-400"></i>',
                    buttons: [{text: "Tutup"}]
                });
                
                // Kunci pilihan jawaban setelah berhasil dikirim
                document.querySelectorAll('.kegiatan-checkbox').forEach(el => el.disabled = true);
                document.querySelectorAll('select[name^="kegC_"]').forEach(el => el.disabled = true);
                document.getElementById('btn-kirim-kegiatan').classList.add('hidden');
            } catch(e) {
                hideModal();
                showModal({
                    title: "Gagal Mengirim", 
                    message: "Terjadi kesalahan koneksi, coba lagi.", 
                    icon: '<i class="fa-solid fa-xmark text-red-500"></i>',
                    buttons: [{text: "Tutup"}]
                });
            }
        }

        // Quiz Logic
        window.startQuiz = () => {
            const name = document.getElementById('student-name').value.trim();
            const cls = document.getElementById('student-class').value.trim();
            
            if(!name || !cls) {
                return showModal({
                    title: "Ups!", 
                    message: "Isi nama dan kelas terlebih dahulu.", 
                    icon: '<i class="fa-solid fa-exclamation text-yellow-500"></i>', 
                    buttons: [{text: "Oke"}]
                });
            }

            document.getElementById('display-name').textContent = name;
            document.getElementById('quiz-login').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            
            const form = document.getElementById('quiz-form');
            form.innerHTML = "";
            
            quizData.forEach((item, idx) => {
                const qDiv = document.createElement('div');
                qDiv.className = "bg-white p-5 rounded-2xl shadow-sm border border-slate-100";
                
                let optsHtml = "";
                item.options.forEach((opt, oIdx) => {
                    optsHtml += `
                        <label class="option-label block relative mb-3 rounded-xl overflow-hidden">
                            <input type="radio" name="q${idx}" value="${oIdx}" class="option-input absolute opacity-0 w-full h-full cursor-pointer z-10">
                            <div class="option-content p-3 flex items-center transition-colors">
                                <span class="option-circle w-8 h-8 rounded-full border-2 border-slate-300 flex items-center justify-center mr-3 text-sm font-bold text-slate-500 flex-shrink-0">
                                    ${String.fromCharCode(65 + oIdx)}
                                </span>
                                <span class="text-slate-700 font-medium">${opt}</span>
                            </div>
                        </label>
                    `;
                });
                
                qDiv.innerHTML = `
                    <p class="font-bold text-lg text-blue-800 mb-4 font-['Fredoka'] leading-relaxed">
                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded text-sm mr-2 align-middle">No. ${idx + 1}</span>
                        <span class="align-middle">${item.q}</span>
                    </p>
                    <div>${optsHtml}</div>
                `;
                form.appendChild(qDiv);
            });
            
            if (window.MathJax) MathJax.typesetPromise();
        };

        window.preSubmitCheck = () => {
            let answered = 0;
            quizData.forEach((_, i) => { 
                if(document.querySelector(`input[name="q${i}"]:checked`)) answered++; 
            });
            
            if(answered < quizData.length) {
                showModal({
                    title: "Belum Selesai", 
                    message: `Baru dikerjakan ${answered} dari ${quizData.length} soal.`, 
                    buttons: [
                        {text: "Lanjut"}, 
                        {text: "Kirim Tetap", action: submitQuiz}
                    ]
                });
            } else {
                submitQuiz();
            }
        };

        async function submitQuiz() {
            showModal({
                title: "Mengirim...", 
                message: "Menyimpan nilai Anda...", 
                icon: '<i class="fa-solid fa-spinner fa-spin"></i>', 
                buttons: []
            });
            
            let correct = 0;
            quizData.forEach((item, i) => {
                const sel = document.querySelector(`input[name="q${i}"]:checked`);
                if(sel && parseInt(sel.value) === item.a) correct++;
            });
            
            const score = Math.round((correct / quizData.length) * 100);
            
            try {
                if(!currentUser) await signInAnonymously(auth);
                
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'scores'), {
                    name: document.getElementById('student-name').value, 
                    kelas: document.getElementById('student-class').value, 
                    score: score, 
                    materi: 'Evaluasi Kimia',
                    date: new Date().toLocaleDateString('id-ID'),
                    timestamp: Date.now()
                });
                
                hideModal();
                showModal({
                    title: "Selesai!", 
                    message: `Luar Biasa! Nilai Anda: <strong>${score}</strong>`, 
                    icon: '<i class="fa-solid fa-medal text-yellow-400"></i>',
                    buttons: [{text: "Tutup", action: () => location.reload()}]
                });
            } catch(e) {
                hideModal();
                showModal({
                    title: "Gagal Mengirim", 
                    message: "Terjadi kesalahan koneksi, coba lagi.", 
                    icon: '<i class="fa-solid fa-xmark text-red-500"></i>',
                    buttons: [{text: "Tutup"}]
                });
            }
        }

        // Modal Logic
        const modal = document.getElementById('custom-modal');
        const mTitle = document.getElementById('modal-title');
        const mBody = document.getElementById('modal-body');
        const mIcon = document.getElementById('modal-icon');
        const mActions = document.getElementById('modal-actions');
        
        window.showModal = (cfg) => {
            mTitle.textContent = cfg.title; 
            mBody.innerHTML = cfg.message; 
            mIcon.innerHTML = cfg.icon || ''; 
            mActions.innerHTML = '';
            
            cfg.buttons.forEach(btn => {
                const b = document.createElement('button'); 
                b.className = "flex-1 py-3 rounded-xl font-bold bg-blue-100 hover:bg-blue-200 text-blue-800 transition transform active:scale-95"; 
                b.innerHTML = btn.text;
                b.onclick = () => { 
                    if(btn.action) btn.action(); 
                    else hideModal(); 
                }; 
                mActions.appendChild(b);
            });
            
            modal.classList.remove('hidden');
        };
        
        window.hideModal = () => modal.classList.add('hidden');
        
        // Mobile Menu
        document.getElementById('mobile-menu-btn').onclick = () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        };
    </script>
</body>
</html>
