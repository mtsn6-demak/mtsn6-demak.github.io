<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uji Kompetensi Fiqih - MTsN 6 Demak</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0fdf4; /* Light Green background */
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2316a34a' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }
        /* Custom Radio Button Styling */
        .option-label {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .option-input:checked + .option-content {
            background-color: #dcfce7; /* green-100 */
            border-color: #16a34a; /* green-600 */
            color: #15803d;
        }
        .option-input:checked + .option-content .check-icon {
            opacity: 1;
            transform: scale(1);
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <!-- Navbar / Header -->
    <header class="w-full bg-green-700 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <!-- Logo School -->
                <a href="#" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-green-700 font-bold text-lg border-2 border-green-200 hover:bg-green-50 transition">
                    <i class="fa-solid fa-chevron-left"></i>
                </a>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Uji Kompetensi</h1>
                    <p class="text-xs text-green-100">Bab: Shalat Jum'at</p>
                </div>
            </div>
            <div class="text-sm font-medium bg-green-800 px-3 py-1 rounded-full border border-green-600">
                <i class="fa-regular fa-clock mr-1"></i> 28 Soal
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow w-full max-w-2xl px-4 py-8 flex flex-col items-center">

        <!-- Form Identitas -->
        <div id="identitySection" class="glass-card w-full rounded-2xl p-6 mb-6 border-l-4 border-blue-500 animate-fade-in">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fa-solid fa-id-card text-blue-500 mr-2"></i> Identitas Siswa
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">Nama Lengkap</label>
                    <input type="text" id="namaSiswa" class="w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white/50" placeholder="Contoh: Muhammad Rizki">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">Kelas</label>
                    <select id="kelasSiswa" class="w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white/50">
                        <option value="">-- Pilih Kelas --</option>
                        <option value="7A">7A</option>
                        <option value="7B">7B</option>
                        <option value="7C">7C</option>
                        <option value="7D">7D</option>
                    </select>
                </div>
            </div>
            <button type="button" id="btnStart" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl shadow-md transition transform hover:-translate-y-1 flex items-center justify-center space-x-2">
                <span>Mulai Mengerjakan</span>
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </div>

        <!-- Exam Section (Hidden Initially) -->
        <div id="examSection" class="hidden w-full transition-all duration-500">
            
            <!-- Info Card -->
            <div class="glass-card w-full rounded-2xl p-6 mb-6 border-l-4 border-green-500 animate-fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-2">Petunjuk Pengerjaan</h2>
                <div class="text-gray-600 text-sm mb-4 space-y-1">
                    <p>1. <strong>Bagian A (Pilihan Ganda):</strong> Pilihlah satu jawaban yang paling benar.</p>
                    <p>2. <strong>Bagian B (Menjodohkan):</strong> Pasangkan pernyataan di sebelah kiri dengan jawaban yang tepat di sebelah kanan.</p>
                    <p>3. Setelah selesai, klik tombol "Selesai" untuk mengirim jawaban.</p>
                </div>
                <div class="flex items-center text-xs text-gray-500 space-x-4">
                    <span class="flex items-center"><i class="fa-solid fa-user-tie mr-2 text-green-600"></i> Ahmad Zulfikar, S.Pd.</span>
                    <span class="flex items-center"><i class="fa-solid fa-book-open mr-2 text-green-600"></i> Fiqih / Kelas 7</span>
                </div>
            </div>

            <!-- Quiz Form -->
            <form id="quizForm" class="w-full space-y-8">
                
                <!-- Bagian A: Pilihan Ganda -->
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b-2 border-green-200 pb-2 inline-block">A. Pilihan Ganda</h3>
                    <div id="questionsContainer"></div>
                </div>

                <!-- Bagian B: Menjodohkan -->
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b-2 border-green-200 pb-2 inline-block">B. Menjodohkan</h3>
                    <div id="matchingContainer" class="space-y-4"></div>
                </div>

                <!-- Submit Button -->
                <div class="sticky bottom-4 z-40 pb-4 pt-2">
                    <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 rounded-xl shadow-lg transform transition hover:-translate-y-1 active:scale-95 flex items-center justify-center space-x-2">
                        <i class="fa-solid fa-paper-plane"></i>
                        <span>Selesai & Kirim Jawaban</span>
                    </button>
                </div>
            </form>
        </div>

    </main>

    <!-- Footer -->
    <footer class="w-full bg-gray-800 text-gray-400 py-6 text-center text-xs mt-auto">
        <div class="max-w-2xl mx-auto px-4">
            <p class="mb-2">&copy; 2026 MTsN 6 Demak. All Rights Reserved.</p>
            <p>E-Learning System</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA SOAL PILIHAN GANDA (20 Soal) ---
        const pgQuestions = [
            { id: 1, text: "Shalat jumat adalah shalat yang khusus dilaksanakan pada hari jumat pada waktu ....", options: { a: "Subuh", b: "Dhuhur", c: "Asar", d: "Magrib" }, correct: "b" },
            { id: 2, text: "Khutbah dua kali termasuk bagian dari.......... ibadah sholat Jum'at.", options: { a: "Sunnah", b: "Keutamaan", c: "Syarat", d: "Rukun" }, correct: "c" },
            { id: 3, text: "Berikut ini yang bukan merupakan rukun dari khutbah Jum'at adalah....", options: { a: "Mengucapkan puji-pujian kepada Allah", b: "Memperbanyak membaca takbir", c: "Berwasiat agar senantiasa bertaqwa kepada Allah", d: "Membaca beberapa ayat Al-Qur'an" }, correct: "b" },
            { id: 4, text: "Mandi, memotong kuku, kumis, memakai wangi-wangian dan berpakian bersih dan rapi termasuk kedalam .... ibadah Jum'at.", options: { a: "Rukun", b: "Syarat sah", c: "Syarat Wajib", d: "Sunnah" }, correct: "d" },
            { id: 5, text: "Melaksanakan shalat Jum'at bagi seorang laki-laki muslim yang telah baligh (dewasa), sehat jasmani dan rohani, merdeka, serta bukan musafir hukumnya....", options: { a: "Sunnah muakadah", b: "Wajib 'ain", c: "Wajib Kifayah", d: "Sunnah ghairu muakad" }, correct: "b" },
            { id: 6, text: "Rukun shalat jumat yang dapat dijadikan sebagai media pendidikan bagi umat Islam adalah ....", options: { a: "Azan", b: "Shalat tahiyatul masjid", c: "Duduk", d: "Khutbah" }, correct: "d" },
            { id: 7, text: "Salah satu hikmah shalat jumat bagi umat Islam dalam bidang sosial adalah ....", options: { a: "Menggerakkan perekonomian umat", b: "Sebagai sarana untuk menambah ilmu agama", c: "Mempererat tali silaturahmi dan persatuan umat", d: "Meningkatkan rasa takut kepada Allah" }, correct: "c" },
            { id: 8, text: "Hikmah bagi umat Islam ketika duduk di lantai masjid mendengarkan khutbah adalah ....", options: { a: "Menujukkan bahwa wibawa dan kehormatan tidak penting dalam agama Islam", b: "Lebih menghemat biaya dalam pelaksanaan ibadah", c: "Adanya perbedaan status sosial bagi yang menempati shaf depan dan belakang", d: "Menunjukkan kerendahan hati dan persamaan manusia di hadapan Tuhan" }, correct: "d" },
            { id: 9, text: "4 golongan yang boleh meninggalkan sholat jum'at menurut hadist (hamba sahaya, wanita, anak kecil, orang sakit), kecuali ...", arab: "إِلَّا أَرْبَعَةً: عَبْدُ مَمْلُوكٌ أَوِ امْرَأَةٌ أَو صَبِيٌّ أَوْ مَرِيضٌ", options: { a: "Orang yang sakit", b: "Anak-anak", c: "Orang yang super sibuk", d: "Perempuan" }, correct: "c" },
            { id: 10, text: "Sebelum mengikuti ibadah jum'at kita disunnahkan untuk melaksanakan hal berikut, kecuali....", options: { a: "Mandi besar", b: "Menggunakan wangi-wangian", c: "Mengucapkan kalimat talbiyah", d: "Memakai pakaian terbaik, berwarna putih" }, correct: "c" },
            { id: 11, text: "Diantara nilai-nilai dalam rangkaian ibadah Jum'at adalah, kecuali ....", options: { a: "Memilih Mengingat Allah dibanding keduniawian", b: "Disiplin waktu", c: "Membiasakan tidur siang ketika khutbah", d: "Nilai kebersamaan" }, correct: "c" },
            { id: 12, text: "Waktu do'a mustajab di hari Jum'at yang hendaknya kita manfaatkan untuk banyak berdo'a adalah ketika....", options: { a: "Khatib duduk diantara dua khutbah", b: "Khatib mengucap salam", c: "Selesai ibadah jum'at", d: "Sebelum khatib naik mimbar" }, correct: "a" },
            { id: 13, text: "QS. Al-Jumuah: 9 memerintahkan bahwa ketika ada panggilan sholat jum'at, hendaknya kita bersegera mengingat Allah dan ....", options: { a: "Meninggalkan jual beli", b: "Meneruskan jual beli", c: "Menunggu khutbah dilaksanakan", d: "Menunggu adzan kedua" }, correct: "a" },
            { id: 14, text: "Hadits riwayat Bukhari menyebutkan sholat jum'at dilaksanakan ketika....", arab: "كَانَ يُصَلِّي الْجُمُعَةَ حِيْنَ تَمِيْلُ الشَّمْسُ", options: { a: "Matahari naik sepenggalah", b: "Matahari telah tergelincir", c: "Matahari akan terbenam", d: "Matahari akan berada ditengah-tengah" }, correct: "b" },
            { id: 15, text: "Salah satu sunnah yang hendaknya dikerjakan ketika khutbah Jum'at adalah ....", options: { a: "Tema khutbah disesuaikan dengan kebutuhan dan kondisi jama'ah", b: "Khutbah hendaknya panjang dan bahasa yang indah", c: "Khutbah dilakukan dengan penuh semangat dan menggebu-gebu", d: "Berwasiat kepada diri sendiri dan jama'ah untuk bertaqwa" }, correct: "a" },
            { id: 16, text: "Apabila kita berkata kepada anak-anak pada saat khutbah Jum'at dengan kata-kata 'diamlah' maka ibadah sholat jum'at kita ....", options: { a: "Afdhol", b: "Berpahala", c: "Keutamaan", d: "Sia-sia" }, correct: "d" },
            { id: 17, text: "Berikut adalah syarat-syarat seseorang diwajibkan untuk sholat jum'at dan berdosa besar jika meninggalkannya yaitu, kecuali....", options: { a: "Orang yang mukim", b: "Laki-laki, merdeka, sehat", c: "Anak laki-laki", d: "Baligh" }, correct: "c" },
            { id: 18, text: "Hal-hal yang dapat membatalkan pahala ibadah sholat jum'at seseorang adalah ....", options: { a: "Mendengarkan khutbah", b: "Bercakap-cakap ketika khatib berkhutbah", c: "Lupa tidak mandi sebelum sholat jum'at", d: "Menahan kantuk ketika khatib berkhutbah" }, correct: "b" },
            { id: 19, text: "Dalil kewajiban melaksanakan sholat Jum'at terdapat dalam Al-Qur'an surah ....", options: { a: "Al-Jumuah : 9", b: "Al-Jumuah : 19", c: "Al-Jumuah : 29", d: "Al-Jumuah : 39" }, correct: "a" },
            { id: 20, text: "Jumlah rekaat shalat jumat adalah....", options: { a: "2", b: "3", c: "4", d: "5" }, correct: "a" }
        ];

        // --- DATA SOAL MENJODOHKAN (8 Soal Baru) ---
        const matchingData = [
            { id: "m1", question: "Waktu didirikannya sholat Jum’at", answer: "Saat matahari tergelincir" },
            { id: "m2", question: "Waktu mustajab untuk berdoa ketika khatib duduk di antara dua khutbah", answer: "Waktu mustajab" },
            { id: "m3", question: "Dalil Al-Qur’an tentang kewajiban sholat Jum’at", answer: "QS. Al-Jumu’ah ayat 9" },
            { id: "m4", question: "Hukum sholat dhuhur bagi orang yang sudah melaksanakan sholat Jum’at", answer: "Tidak wajib sholat dhuhur" },
            { id: "m5", question: "Cara pelaksanaan sholat Jum’at", answer: "Berjamaah" },
            { id: "m6", question: "Hukum mandi besar sebelum sholat Jum’at", answer: "Sunnah" },
            { id: "m7", question: "Sholat dua rakaat sebelum duduk menunggu khutbah", answer: "Sholat tahiyatul masjid" },
            { id: "m8", question: "Do’a untuk kaum muslimin dalam khutbah Jum’at", answer: "Rukun khutbah Jum’at" }
        ];
        
        // Pilihan jawaban untuk dropdown (Diambil dari Kolom B)
        const matchingOptions = [
            "Sunnah",
            "Tidak wajib sholat dhuhur",
            "QS. Al-Jumu’ah ayat 9",
            "Saat matahari tergelincir",
            "Rukun khutbah Jum’at",
            "Berjamaah",
            "Waktu mustajab",
            "Sholat tahiyatul masjid"
        ];

        // --- RENDER FUNCTIONS ---

        function renderPG() {
            const container = document.getElementById('questionsContainer');
            let html = '';

            pgQuestions.forEach((q, index) => {
                html += `
                <div class="glass-card rounded-2xl p-5 mb-4 border border-white/50" id="card-${q.id}">
                    <div class="flex items-start mb-4">
                        <span class="flex-shrink-0 w-8 h-8 bg-green-100 text-green-700 rounded-full flex items-center justify-center font-bold text-sm mr-3 border border-green-200">${index + 1}</span>
                        <div class="w-full">
                            <p class="text-gray-800 font-medium text-lg leading-relaxed">${q.text}</p>
                            ${q.arab ? `<p class="text-right font-serif text-2xl my-3 text-gray-700 bg-gray-50 p-2 rounded border border-gray-100">${q.arab}</p>` : ''}
                        </div>
                    </div>
                    <div class="space-y-3 pl-0 md:pl-11">
                        ${['a', 'b', 'c', 'd'].map(opt => `
                            <label class="option-label block relative group">
                                <input type="radio" name="q${q.id}" value="${opt}" class="option-input peer absolute opacity-0">
                                <div class="option-content bg-white/60 hover:bg-white border-2 border-transparent p-3 rounded-xl flex items-center text-gray-600 transition-all shadow-sm peer-checked:shadow-md">
                                    <span class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center text-xs font-bold mr-3 bg-gray-50 peer-checked:bg-green-500 peer-checked:text-white peer-checked:border-green-500 transition-colors uppercase">${opt}</span>
                                    <span class="flex-grow text-sm md:text-base">${q.options[opt]}</span>
                                    <i class="check-icon fa-solid fa-circle-check text-green-600 text-xl ml-2 opacity-0 transform scale-0 transition-all duration-300"></i>
                                </div>
                            </label>
                        `).join('')}
                    </div>
                </div>
                `;
            });
            container.innerHTML = html;
        }

        function renderMatching() {
            const container = document.getElementById('matchingContainer');
            let html = '';

            // Generate options HTML sorted alphabetically for UX, or randomized
            const optionsHtml = matchingOptions.sort().map(opt => `<option value="${opt}">${opt}</option>`).join('');

            matchingData.forEach((item, index) => {
                html += `
                <div class="glass-card rounded-2xl p-5 border border-white/50 flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div class="flex items-start md:w-2/3">
                        <span class="flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center font-bold text-sm mr-3 border border-blue-200">${index + 1}</span>
                        <p class="text-gray-800 font-medium pt-1">${item.question}</p>
                    </div>
                    <div class="w-full md:w-1/3">
                        <select name="match_${item.id}" class="w-full p-3 border border-gray-300 rounded-xl bg-white focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none cursor-pointer">
                            <option value="" disabled selected>-- Pilih Pasangan --</option>
                            ${optionsHtml}
                        </select>
                    </div>
                </div>
                `;
            });
            container.innerHTML = html;
        }

        // --- NEW LOGIC: Start Button Handler ---
        document.getElementById('btnStart').addEventListener('click', function() {
            // Validasi Identitas
            const nama = document.getElementById('namaSiswa').value.trim();
            const kelas = document.getElementById('kelasSiswa').value;

            if (!nama || !kelas) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Identitas Belum Lengkap',
                    text: 'Mohon isi Nama Lengkap dan Kelas terlebih dahulu!',
                    confirmButtonColor: '#16a34a'
                });
                return;
            }

            // Lock Input & Hide Start Button
            document.getElementById('namaSiswa').disabled = true;
            document.getElementById('kelasSiswa').disabled = true;
            this.classList.add('hidden'); 

            // Show Exam Section with Animation
            const examSection = document.getElementById('examSection');
            examSection.classList.remove('hidden');
            examSection.classList.add('animate-fade-in');

            // Scroll to questions gently
            setTimeout(() => {
                examSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        });

        // Handle Form Submission
        document.getElementById('quizForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Re-validate
            const nama = document.getElementById('namaSiswa').value.trim();
            const kelas = document.getElementById('kelasSiswa').value;

            // Konfirmasi sebelum kirim
            Swal.fire({
                title: 'Kirim Jawaban?',
                text: "Pastikan semua jawaban sudah terisi. Anda akan langsung diarahkan ke halaman nilai.",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#2563eb', // Blue
                cancelButtonColor: '#9ca3af',
                confirmButtonText: 'Ya, Kirim!',
                cancelButtonText: 'Cek Lagi'
            }).then((result) => {
                if (result.isConfirmed) {
                    processSubmission(nama, kelas);
                }
            });
        });

        function processSubmission(nama, kelas) {
            let totalScore = 0;
            const formData = new FormData(document.getElementById('quizForm'));

            // 1. Hitung Nilai PG (Bobot 3 poin per soal -> 20x3 = 60)
            pgQuestions.forEach(q => {
                const userAns = formData.get(`q${q.id}`);
                if (userAns === q.correct) {
                    totalScore += 3;
                }
            });

            // 2. Hitung Nilai Menjodohkan (Bobot 5 poin per soal -> 8x5 = 40)
            matchingData.forEach(m => {
                const userAns = formData.get(`match_${m.id}`);
                if (userAns === m.answer) {
                    totalScore += 5;
                }
            });

            // Tampilkan Loading
            Swal.fire({
                title: 'Mengirim Jawaban...',
                text: 'Mohon tunggu, sedang memproses nilai.',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            // URL Target
            const targetBaseUrl = "https://mtsn6-demak.github.io/nilai-siswa/";
            const targetUrl = `${targetBaseUrl}?name=${encodeURIComponent(nama)}&score=${totalScore}&kelas=${encodeURIComponent(kelas)}&type=Kuis Fiqih&date=${encodeURIComponent(new Date().toLocaleDateString('id-ID'))}`;
            
            // Redirect
            setTimeout(() => {
                try {
                    window.location.href = targetUrl;
                } catch (error) {
                    console.error("Redirect Error:", error);
                    Swal.fire({
                        icon: 'success',
                        title: 'Selesai!',
                        html: `Terima kasih <b>${nama}</b>.<br>Nilai Anda: <b>${totalScore}</b>.<br><br><a href="${targetUrl}" target="_blank" class="text-blue-600 underline">Klik di sini jika tidak otomatis dialihkan</a>`
                    });
                }
            }, 1500);
        }

        // Initialize Render
        renderPG();
        renderMatching();

    </script>
</body>
</html>
