<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uji Kompetensi IPA - Getaran & Gelombang</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0fdf4; /* Light Green background */
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2316a34a' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }
        /* Custom Radio Button Styling */
        .option-label {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .option-input:checked + .option-content {
            background-color: #dcfce7; /* green-100 */
            border-color: #16a34a; /* green-600 */
            color: #15803d;
        }
        .option-input:checked + .option-content .check-icon {
            opacity: 1;
            transform: scale(1);
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        /* Style adjustments for image options */
        .option-content svg {
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <!-- Navbar / Header -->
    <header class="w-full bg-green-700 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <!-- Logo School -->
                <a href="#" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-green-700 font-bold text-lg border-2 border-green-200 hover:bg-green-50 transition">
                    <i class="fa-solid fa-chevron-left"></i>
                </a>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Uji Kompetensi IPA</h1>
                    <p class="text-xs text-green-100">Bab: Getaran, Gelombang & Bunyi</p>
                </div>
            </div>
            <div class="text-sm font-medium bg-green-800 px-3 py-1 rounded-full border border-green-600">
                <i class="fa-regular fa-clock mr-1"></i> 30 Soal
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow w-full max-w-2xl px-4 py-8 flex flex-col items-center">

        <!-- Form Identitas -->
        <div id="identitySection" class="glass-card w-full rounded-2xl p-6 mb-6 border-l-4 border-blue-500 animate-fade-in">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fa-solid fa-id-card text-blue-500 mr-2"></i> Identitas Siswa
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">Nama Lengkap</label>
                    <input type="text" id="namaSiswa" class="w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white/50" placeholder="Contoh: Budi Santoso">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">Kelas</label>
                    <select id="kelasSiswa" class="w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white/50">
                        <option value="">-- Pilih Kelas --</option>
                        <option value="8A">8A</option>
                        <option value="8B">8B</option>
                        <option value="8C">8C</option>
                        <option value="8D">8D</option>
                    </select>
                </div>
            </div>
            <button type="button" id="btnStart" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl shadow-md transition transform hover:-translate-y-1 flex items-center justify-center space-x-2">
                <span>Mulai Mengerjakan</span>
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </div>

        <!-- Exam Section (Hidden Initially) -->
        <div id="examSection" class="hidden w-full transition-all duration-500">
            
            <!-- Info Card -->
            <div class="glass-card w-full rounded-2xl p-6 mb-6 border-l-4 border-green-500 animate-fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-2">Petunjuk Pengerjaan</h2>
                <div class="text-gray-600 text-sm mb-4 space-y-1">
                    <p>1. <strong>Bagian A (Pilihan Ganda):</strong> Pilihlah satu jawaban yang paling benar.</p>
                    <p>2. <strong>Bagian B (Menjodohkan):</strong> Pasangkan pernyataan soal dengan jawaban yang tepat.</p>
                    <p>3. Perhatikan gambar atau tabel yang tersedia pada beberapa nomor soal.</p>
                    <p>4. Setelah selesai, klik tombol "Selesai & Kirim Jawaban" untuk melihat nilai Anda.</p>
                </div>
                <div class="flex items-center text-xs text-gray-500 space-x-4">
                    <span class="flex items-center"><i class="fa-solid fa-flask mr-2 text-green-600"></i> Guru IPA</span>
                    <span class="flex items-center"><i class="fa-solid fa-book-open mr-2 text-green-600"></i> Fisika Kelas 8</span>
                </div>
            </div>

            <!-- Quiz Form -->
            <form id="quizForm" class="w-full space-y-8">
                
                <!-- Bagian A: Pilihan Ganda -->
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b-2 border-green-200 pb-2 inline-block">A. Pilihan Ganda</h3>
                    <div id="questionsContainer"></div>
                </div>

                <!-- Bagian B: Menjodohkan -->
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b-2 border-green-200 pb-2 inline-block">B. Menjodohkan</h3>
                    <div id="matchingContainer" class="space-y-4"></div>
                </div>

                <!-- Submit Button -->
                <div class="sticky bottom-4 z-40 pb-4 pt-2">
                    <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 rounded-xl shadow-lg transform transition hover:-translate-y-1 active:scale-95 flex items-center justify-center space-x-2">
                        <i class="fa-solid fa-paper-plane"></i>
                        <span>Selesai & Kirim Jawaban</span>
                    </button>
                </div>
            </form>
        </div>

    </main>

    <!-- Footer -->
    <footer class="w-full bg-gray-800 text-gray-400 py-6 text-center text-xs mt-auto">
        <div class="max-w-2xl mx-auto px-4">
            <p class="mb-2">&copy; 2026 E-Learning System. All Rights Reserved.</p>
            <p>Tes Formatif Fisika</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA SOAL PILIHAN GANDA (20 Soal) ---
        
        // --- 1. Definisi SVG Soal (Ilustrasi Soal) ---
        const soalSvgs = {
            slinki_fixed: `
            <svg viewBox="0 0 500 140" class="w-full h-auto max-w-lg mx-auto border border-gray-200 rounded bg-white p-2">
                <style>.rapatan {stroke-width: 3; stroke: #333;} .regangan {stroke-width: 2; fill: none; stroke: #333;}</style>
                <!-- Labels -->
                <text x="60" y="25" font-size="12" fill="#555" text-anchor="middle">rapatan</text>
                <text x="240" y="25" font-size="12" fill="#555" text-anchor="middle">rapatan</text>
                <text x="420" y="25" font-size="12" fill="#555" text-anchor="middle">rapatan</text>
                <text x="150" y="115" font-size="12" fill="#555" text-anchor="middle">regangan</text>
                <text x="330" y="115" font-size="12" fill="#555" text-anchor="middle">regangan</text>

                <!-- Gelombang Slinki -->
                <!-- Rapatan 1 -->
                <line x1="40" y1="40" x2="40" y2="90" class="rapatan"/><line x1="45" y1="40" x2="45" y2="90" class="rapatan"/><line x1="50" y1="40" x2="50" y2="90" class="rapatan"/><line x1="55" y1="40" x2="55" y2="90" class="rapatan"/><line x1="60" y1="40" x2="60" y2="90" class="rapatan"/><line x1="65" y1="40" x2="65" y2="90" class="rapatan"/><line x1="70" y1="40" x2="70" y2="90" class="rapatan"/><line x1="75" y1="40" x2="75" y2="90" class="rapatan"/><line x1="80" y1="40" x2="80" y2="90" class="rapatan"/>
                
                <!-- Regangan 1 (Sine wave style) -->
                <path d="M80,65 Q97.5,15 115,65 T150,65 T185,65 T220,65" class="regangan"/>
                
                <!-- Rapatan 2 -->
                <line x1="220" y1="40" x2="220" y2="90" class="rapatan"/><line x1="225" y1="40" x2="225" y2="90" class="rapatan"/><line x1="230" y1="40" x2="230" y2="90" class="rapatan"/><line x1="235" y1="40" x2="235" y2="90" class="rapatan"/><line x1="240" y1="40" x2="240" y2="90" class="rapatan"/><line x1="245" y1="40" x2="245" y2="90" class="rapatan"/><line x1="250" y1="40" x2="250" y2="90" class="rapatan"/><line x1="255" y1="40" x2="255" y2="90" class="rapatan"/><line x1="260" y1="40" x2="260" y2="90" class="rapatan"/>

                <!-- Regangan 2 -->
                <path d="M260,65 Q277.5,15 295,65 T330,65 T365,65 T400,65" class="regangan"/>

                <!-- Rapatan 3 -->
                <line x1="400" y1="40" x2="400" y2="90" class="rapatan"/><line x1="405" y1="40" x2="405" y2="90" class="rapatan"/><line x1="410" y1="40" x2="410" y2="90" class="rapatan"/><line x1="415" y1="40" x2="415" y2="90" class="rapatan"/><line x1="420" y1="40" x2="420" y2="90" class="rapatan"/><line x1="425" y1="40" x2="425" y2="90" class="rapatan"/><line x1="430" y1="40" x2="430" y2="90" class="rapatan"/><line x1="435" y1="40" x2="435" y2="90" class="rapatan"/><line x1="440" y1="40" x2="440" y2="90" class="rapatan"/>
                
                <!-- Dimension Line -->
                <line x1="40" y1="100" x2="440" y2="100" stroke="#000" stroke-width="1" />
                <line x1="40" y1="95" x2="40" y2="105" stroke="#000" />
                <line x1="440" y1="95" x2="440" y2="105" stroke="#000" />
                <text x="240" y="115" font-size="12" font-weight="bold" bg="white" fill="black" text-anchor="middle" style="fill:white; stroke:white; stroke-width:3px; paint-order:stroke;">1 m</text>
                <text x="240" y="115" font-size="12" font-weight="bold" text-anchor="middle">1 m</text>
            </svg>`,

            waveTransversal: `<svg viewBox="0 0 300 120" class="w-full h-auto max-w-sm mx-auto border border-gray-200 rounded bg-white"><path d="M10,60 Q45,10 80,60 T150,60 T220,60 T290,60" fill="none" stroke="#2563eb" stroke-width="3"/><line x1="10" y1="60" x2="290" y2="60" stroke="#999" stroke-dasharray="4"/><text x="45" y="30" font-size="12" text-anchor="middle">Bukit</text><text x="115" y="100" font-size="12" text-anchor="middle">Lembah</text></svg>`,
            waveAmplitude: `<svg viewBox="0 0 300 150" class="w-full h-auto max-w-sm mx-auto border border-gray-200 rounded bg-white"><path d="M20,75 Q85,-25 150,75 T280,75" fill="none" stroke="#2563eb" stroke-width="3"/><line x1="20" y1="75" x2="280" y2="75" stroke="#000" stroke-width="1"/><line x1="20" y1="20" x2="20" y2="130" stroke="#000" stroke-width="1"/><line x1="18" y1="20" x2="22" y2="20" stroke="#000"/><line x1="18" y1="130" x2="22" y2="130" stroke="#000"/><text x="5" y="80" font-size="12">2m</text><line x1="20" y1="10" x2="150" y2="10" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><line x1="20" y1="10" x2="150" y2="10" stroke="#000"/><text x="80" y="25" font-size="12" text-anchor="middle">4 m</text></svg>`,
            waveCork: `<svg viewBox="0 0 300 150" class="w-full h-auto max-w-sm mx-auto border border-gray-200 rounded bg-white"><path d="M20,75 Q50,15 80,75 T140,75 T200,75 T260,75" fill="none" stroke="#2563eb" stroke-width="2"/><circle cx="80" cy="75" r="8" fill="#eab308" stroke="#000"/><rect x="75" y="70" width="10" height="10" fill="brown"/><line x1="20" y1="120" x2="140" y2="120" stroke="#000" marker-end="url(#arrow)" marker-start="url(#arrow)"/><text x="80" y="135" font-size="12" text-anchor="middle">2 m (1 gelombang)</text></svg>`,
            waveAB: `<svg viewBox="0 0 350 160" class="w-full h-auto max-w-md mx-auto border border-gray-200 rounded bg-white p-2"><defs><marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="#000" /></marker></defs><line x1="30" y1="80" x2="330" y2="80" stroke="#000" stroke-width="1" /><line x1="30" y1="20" x2="30" y2="140" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><text x="20" y="25" font-size="12" font-style="italic">y</text><text x="335" y="85" font-size="12" font-style="italic">t (s)</text><path d="M30,80 q35,-60 70,0 t70,0 t70,0 t70,0" fill="none" stroke="#000" stroke-width="2" /><text x="25" y="95" font-weight="bold">A</text><text x="310" y="95" font-weight="bold">B</text><circle cx="30" cy="80" r="3" fill="black"/><circle cx="310" cy="80" r="3" fill="black"/><line x1="30" y1="40" x2="100" y2="40" stroke="#000" stroke-width="1" stroke-dasharray="4"/><line x1="30" y1="40" x2="30" y2="80" stroke="#000" stroke-width="1" stroke-dasharray="2"/><line x1="100" y1="40" x2="100" y2="80" stroke="#000" stroke-width="1" stroke-dasharray="2"/><path d="M30,40 L35,37 L35,43 Z" fill="black"/><path d="M100,40 L95,37 L95,43 Z" fill="black"/><text x="65" y="35" font-size="12" text-anchor="middle">4 m</text></svg>`,
            prism: `<svg viewBox="0 0 300 150" class="w-full h-auto max-w-sm mx-auto border border-gray-200 rounded bg-white"><polygon points="100,20 50,130 150,130" fill="rgba(200,200,255,0.3)" stroke="#333" stroke-width="2"/><line x1="0" y1="80" x2="70" y2="60" stroke="#000" stroke-width="2"/><text x="10" y="75" font-size="10">Cahaya Putih</text><path d="M75,60 L120,60 L180,30" stroke="red" stroke-width="2"/><path d="M75,60 L120,65 L180,50" stroke="orange" stroke-width="2"/><path d="M75,60 L120,70 L180,70" stroke="yellow" stroke-width="2"/><path d="M75,60 L120,75 L180,90" stroke="green" stroke-width="2"/><path d="M75,60 L120,80 L180,110" stroke="blue" stroke-width="2"/><path d="M75,60 L120,85 L180,130" stroke="purple" stroke-width="2"/><text x="190" y="80" font-size="12">Spektrum Warna</text></svg>`,
            lup: `<svg viewBox="0 0 350 150" class="w-full h-auto max-w-sm mx-auto border border-gray-200 rounded bg-white p-2"><line x1="20" y1="75" x2="330" y2="75" stroke="#000" stroke-dasharray="4"/><ellipse cx="200" cy="75" rx="5" ry="50" fill="none" stroke="#000" stroke-width="2"/><text x="190" y="20" font-size="12">lup</text><line x1="140" y1="70" x2="140" y2="80" stroke="#000"/><text x="135" y="95" font-size="14">F</text><line x1="260" y1="70" x2="260" y2="80" stroke="#000"/><text x="255" y="95" font-size="14">F</text><line x1="170" y1="75" x2="170" y2="55" stroke="#000" stroke-width="2" marker-end="url(#arrow)"/><text x="155" y="50" font-size="12">objek</text><path d="M290,75 q15,-15 30,0 q-15,15 -30,0" fill="none" stroke="#000" /><circle cx="305" cy="75" r="3" fill="#000"/><text x="290" y="95" font-size="10">mata</text><text x="285" y="105" font-size="10">pengamat</text><defs><marker id="arrow" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto"><path d="M0,0 L10,5 L0,10 z" fill="#000" /></marker></defs></svg>`
        };

        // --- 2. Definisi SVG Pilihan Jawaban (Option Images) ---
        const optSvgs = {
            // Nomor 18
            q18a: `
            <svg viewBox="0 0 120 100" class="h-24 w-auto mx-auto rounded overflow-hidden" style="background: #0f172a;">
                <!-- Mercusuar -->
                <rect x="50" y="40" width="20" height="60" fill="#e2e8f0"/>
                <rect x="45" y="30" width="30" height="10" fill="#cbd5e1"/>
                <circle cx="60" cy="20" r="10" fill="#fef08a"/>
                <!-- Beams -->
                <path d="M60,20 L120,0 L120,40 Z" fill="rgba(253, 224, 71, 0.4)"/>
                <path d="M60,20 L0,0 L0,40 Z" fill="rgba(253, 224, 71, 0.4)"/>
            </svg>`, 
            q18b: `
            <svg viewBox="0 0 100 100" class="h-24 w-auto mx-auto bg-white rounded border">
                <!-- Glass -->
                <path d="M20,10 L25,90 L75,90 L80,10" fill="none" stroke="#94a3b8" stroke-width="2"/>
                <!-- Water -->
                <path d="M21,30 L79,30 L75,88 L25,88 Z" fill="#bae6fd" opacity="0.5"/>
                <!-- Pencil Top -->
                <rect x="40" y="0" width="10" height="35" fill="#fca5a5" transform="rotate(-15 45 30)"/>
                <!-- Pencil Bottom (Shifted) -->
                <rect x="35" y="35" width="10" height="40" fill="#fca5a5" transform="rotate(-10 40 35)"/>
            </svg>`, 
            q18c: `
            <svg viewBox="0 0 120 80" class="h-24 w-auto mx-auto bg-gray-100 rounded">
                 <!-- Flashlight -->
                <rect x="10" y="30" width="30" height="20" fill="#475569"/>
                <path d="M40,30 L50,20 L50,60 L40,50 Z" fill="#94a3b8"/>
                <!-- Beaker with liquid -->
                <path d="M80,20 L80,70 L110,70 L110,20" fill="none" stroke="#334155" stroke-width="2"/>
                <path d="M80,40 L110,40 L110,68 L80,68 Z" fill="#bae6fd" opacity="0.6"/>
                <!-- Beam Through -->
                <path d="M50,40 L120,30 L120,50 L50,40" fill="rgba(253, 224, 71, 0.3)"/>
            </svg>`, 
            q18d: `
            <svg viewBox="0 0 120 80" class="h-24 w-auto mx-auto bg-sky-100 rounded overflow-hidden">
                <!-- Rainbow -->
                <path d="M20,80 Q60,10 100,80" fill="none" stroke="#ef4444" stroke-width="4"/>
                <path d="M25,80 Q60,20 95,80" fill="none" stroke="#f59e0b" stroke-width="4"/>
                <path d="M30,80 Q60,30 90,80" fill="none" stroke="#22c55e" stroke-width="4"/>
                <path d="M35,80 Q60,40 85,80" fill="none" stroke="#3b82f6" stroke-width="4"/>
                <!-- Cloud -->
                <circle cx="100" cy="20" r="10" fill="#fde047"/>
            </svg>`,
            
            // Nomor 20 (Diagram Lensa Fisika - Schematic)
            // Common Template Vars: Lens Center=75. F=25 units away (50 & 100). 2F=50 units away (25 & 125)
            q20a: `
            <svg viewBox="0 0 200 80" class="h-20 w-auto mx-auto border bg-white rounded">
                <defs><marker id="arrow" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6 z" fill="#000"/></marker></defs>
                <!-- Axis -->
                <line x1="10" y1="40" x2="190" y2="40" stroke="#94a3b8" stroke-dasharray="4"/>
                <!-- Lens -->
                <ellipse cx="100" cy="40" rx="4" ry="30" fill="none" stroke="#000" stroke-width="1.5"/>
                <!-- Labels -->
                <text x="100" y="10" font-size="8" text-anchor="middle">lup</text>
                <text x="180" y="30" font-size="8">mata</text>
                <!-- Eye -->
                <path d="M170,40 Q180,30 190,40 Q180,50 170,40" fill="none" stroke="#000"/>
                <circle cx="180" cy="40" r="2" fill="#000"/>
                <!-- Points -->
                <circle cx="70" cy="40" r="1.5" fill="#000"/><text x="70" y="50" font-size="8" text-anchor="middle">F</text>
                <circle cx="40" cy="40" r="1.5" fill="#000"/><text x="40" y="50" font-size="8" text-anchor="middle">2F</text>
                <circle cx="130" cy="40" r="1.5" fill="#000"/><text x="130" y="50" font-size="8" text-anchor="middle">F</text>
                <!-- Object at 2F (x=40) -->
                <line x1="40" y1="40" x2="40" y2="20" stroke="red" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="40" y="15" font-size="8" text-anchor="middle" fill="red">objek</text>
            </svg>`, 
            
            q20b: `
            <svg viewBox="0 0 200 80" class="h-20 w-auto mx-auto border bg-green-50 rounded">
                <defs><marker id="arrow" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6 z" fill="#000"/></marker></defs>
                <line x1="10" y1="40" x2="190" y2="40" stroke="#94a3b8" stroke-dasharray="4"/>
                <ellipse cx="100" cy="40" rx="4" ry="30" fill="none" stroke="#000" stroke-width="1.5"/>
                <text x="100" y="10" font-size="8" text-anchor="middle">lup</text>
                <text x="180" y="30" font-size="8">mata</text>
                <path d="M170,40 Q180,30 190,40 Q180,50 170,40" fill="none" stroke="#000"/><circle cx="180" cy="40" r="2" fill="#000"/>
                
                <circle cx="70" cy="40" r="1.5" fill="#000"/><text x="70" y="50" font-size="8" text-anchor="middle">F</text>
                <circle cx="40" cy="40" r="1.5" fill="#000"/><text x="40" y="50" font-size="8" text-anchor="middle">2F</text>
                
                <!-- Object between O and F (x=85) -->
                <line x1="85" y1="40" x2="85" y2="20" stroke="red" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="85" y="15" font-size="8" text-anchor="middle" fill="red">objek</text>
            </svg>`, 
            
            q20c: `
            <svg viewBox="0 0 200 80" class="h-20 w-auto mx-auto border bg-white rounded">
                <defs><marker id="arrow" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6 z" fill="#000"/></marker></defs>
                <line x1="10" y1="40" x2="190" y2="40" stroke="#94a3b8" stroke-dasharray="4"/>
                <ellipse cx="100" cy="40" rx="4" ry="30" fill="none" stroke="#000" stroke-width="1.5"/>
                <text x="100" y="10" font-size="8" text-anchor="middle">lup</text>
                <text x="180" y="30" font-size="8">mata</text>
                <path d="M170,40 Q180,30 190,40 Q180,50 170,40" fill="none" stroke="#000"/><circle cx="180" cy="40" r="2" fill="#000"/>
                
                <circle cx="70" cy="40" r="1.5" fill="#000"/><text x="70" y="50" font-size="8" text-anchor="middle">F</text>
                <circle cx="40" cy="40" r="1.5" fill="#000"/><text x="40" y="50" font-size="8" text-anchor="middle">2F</text>

                <!-- Object at F (x=70) -->
                <line x1="70" y1="40" x2="70" y2="20" stroke="red" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="70" y="15" font-size="8" text-anchor="middle" fill="red">objek</text>
            </svg>`, 
            
            q20d: `
            <svg viewBox="0 0 200 80" class="h-20 w-auto mx-auto border bg-white rounded">
                <defs><marker id="arrow" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6 z" fill="#000"/></marker></defs>
                <line x1="10" y1="40" x2="190" y2="40" stroke="#94a3b8" stroke-dasharray="4"/>
                <ellipse cx="100" cy="40" rx="4" ry="30" fill="none" stroke="#000" stroke-width="1.5"/>
                <text x="100" y="10" font-size="8" text-anchor="middle">lup</text>
                <text x="180" y="30" font-size="8">mata</text>
                <path d="M170,40 Q180,30 190,40 Q180,50 170,40" fill="none" stroke="#000"/><circle cx="180" cy="40" r="2" fill="#000"/>
                
                <circle cx="70" cy="40" r="1.5" fill="#000"/><text x="70" y="50" font-size="8" text-anchor="middle">F</text>
                <circle cx="40" cy="40" r="1.5" fill="#000"/><text x="40" y="50" font-size="8" text-anchor="middle">2F</text>

                <!-- Object between F and 2F (x=55) -->
                <line x1="55" y1="40" x2="55" y2="20" stroke="red" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="55" y="15" font-size="8" text-anchor="middle" fill="red">objek</text>
            </svg>` 
        };

        const pgQuestions = [
            { id: 1, text: "Sebuah ayunan bandul yang bergetar memiliki periode 4 sekon, frekuensi ayunan bandul tersebut adalah .....", options: { a: "0,25 Hz", b: "0,5 Hz", c: "2 Hz", d: "4 Hz" }, correct: "a" },
            { id: 2, text: "Sebuah benda bergetar dengan frekuensi 8 Hz, periode benda tersebut adalah .....", options: { a: "0,125 s", b: "0,25 s", c: "0,5 s", d: "0,75 s" }, correct: "a" },
            { id: 3, text: "Perhatikan gambar di bawah ini! Gelombang longitudinal yang panjangnya 1 m terdiri atas 3 rapatan dan 2 regangan. Panjang gelombangnya adalah ....", img: soalSvgs.slinki_fixed, options: { a: "2 m", b: "1 m", c: "0,4 m", d: "1/2 m" }, correct: "c" },
            { id: 4, text: "Perhatikan tabel berikut! Berdasarkan percobaan, jika amplitudo berubah namun frekuensi tetap sama, maka kesimpulannya adalah...", 
              table: `<table class="w-full text-sm text-left text-gray-500 border border-gray-300 mb-3"><thead class="text-xs text-gray-700 uppercase bg-gray-50"><tr><th class="px-4 py-2 border">No</th><th class="px-4 py-2 border">Amplitudo</th><th class="px-4 py-2 border">Periode</th><th class="px-4 py-2 border">Frekuensi</th></tr></thead><tbody><tr><td class="px-4 py-2 border">1</td><td class="px-4 py-2 border">10</td><td class="px-4 py-2 border">0,05 s</td><td class="px-4 py-2 border">20 Hz</td></tr><tr><td class="px-4 py-2 border">2</td><td class="px-4 py-2 border">30</td><td class="px-4 py-2 border">0,05 s</td><td class="px-4 py-2 border">20 Hz</td></tr><tr><td class="px-4 py-2 border">3</td><td class="px-4 py-2 border">60</td><td class="px-4 py-2 border">0,05 s</td><td class="px-4 py-2 border">20 Hz</td></tr></tbody></table>`,
              options: { a: "Periode tergantung pada amplitudo", b: "Amplitudo tergantung pada frekuensi", c: "Periode tidak tergantung pada frekuensi", d: "Frekuensi tidak tergantung pada amplitudo" }, correct: "d" },
            { id: 5, text: "Frekuensi dari suatu getaran sebesar 25 Hz, artinya....", options: { a: "Terjadi 25 getaran dalam 1 menit", b: "Terjadi 25 getaran dalam 1 detik", c: "Terjadi 1/25 getaran dalam 1 menit", d: "Terjadi 1/25 getaran dalam 1 detik" }, correct: "b" },
            { id: 6, text: "Perhatikan gelombang berikut: (1) sinar matahari, (2) gelombang radio, (3) gelombang bunyi, (4) gelombang air, (5) gelombang cahaya. Yang termasuk gelombang elektromagnetik ditunjukkan oleh nomor ....", options: { a: "1 - 2 - 3", b: "1 - 2 - 5", c: "2 - 3 - 4", d: "2 - 4 - 5" }, correct: "b" },
            { id: 7, text: "Perhatikan gambar! Pernyataan berikut yang menggambarkan satu gelombang transversal adalah.....", img: soalSvgs.waveTransversal, options: { a: "Satu bukit dan dua lembah", b: "Satu bukit dan satu lembah", c: "Dua bukit dan dua lembah", d: "Tiga bukit dan tiga lembah" }, correct: "b" },
            { id: 8, text: "Cepat rambat gelombang yang frekuensinya 75 Hz dan panjang gelombangnya 500 cm adalah .... m/s", options: { a: "6,7", b: "25", c: "375", d: "37.500" }, correct: "c" },
            { id: 9, text: "Perhatikan gambar di bawah ini! Jika jarak vertikal (tinggi total) gelombang adalah 2 m, maka amplitudo gelombang tersebut adalah ....", img: soalSvgs.waveAmplitude, options: { a: "1 m", b: "2 m", c: "4 m", d: "8 m" }, correct: "a" },
            { id: 10, text: "Dua buah gelombang tali merambat dengan kecepatan sama. Jika periode gelombang A = 2s dan gelombang B = 4s, maka perbandingan panjang gelombang A dan B adalah ....", options: { a: "2 : 3", b: "3 : 2", c: "2 : 1", d: "1 : 2" }, correct: "d" },
            { id: 11, text: "Perhatikan gambar! Sebuah gabus naik turun di permukaan air 10 kali dalam 5 sekon. Jika panjang satu gelombang 2 m, maka cepat rambat gelombang tersebut adalah...", img: soalSvgs.waveCork, options: { a: "10 m/s", b: "5 m/s", c: "4 m/s", d: "2 m/s" }, correct: "c" },
            { id: 12, text: "Gaung adalah bunyi pantul yang terdengar hampir bersamaan dengan bunyi asli. Gaung dapat diatasi dengan cara ......", options: { a: "Menyesuaikan frekuensi sumber bunyi", b: "Melapisi dinding dengan zat pemantul", c: "Melapisi dinding dengan peredam bunyi", d: "Menurunkan tinggi nada" }, correct: "c" },
            { id: 13, text: "Bunyi yang dapat didengar oleh manusia (audiosonik) berada dalam rentang frekuensi ...", options: { a: "10 - 20 Hz", b: "20 - 10.000 Hz", c: "20 - 20.000 Hz", d: "20 - 100.000 Hz" }, correct: "c" },
            { id: 14, text: "Bunyi pantul dari kedalaman laut terdeteksi setelah 8 detik. Jika cepat rambat bunyi 300 m/s, kedalaman laut itu adalah ....", options: { a: "75 m", b: "300 m", c: "600 m", d: "1.200 m" }, correct: "d" },
            { id: 15, text: "Perhatikan gambar gelombang transversal berikut ini! Jika waktu yang diperlukan dari titik A ke B adalah 8 sekon, maka cepat rambatnya adalah .....", img: soalSvgs.waveAB, options: { a: "8 m/s", b: "6 m/s", c: "4 m/s", d: "2 m/s" }, correct: "d" },
            { id: 16, text: "Alat pengatur cahaya pada mata yang bekerja seperti diafragma pada kamera adalah ....", options: { a: "Iris", b: "Pupil", c: "Retina", d: "Lensa mata" }, correct: "a" },
            { id: 17, text: "Pemantulan pada bidang yang tidak rata (kasar) disebut dengan pemantulan ...", options: { a: "Teratur", b: "Tenang", c: "Baur", d: "Bias" }, correct: "c" },
            { id: 18, text: "Perhatikan ilustrasi berikut! Peristiwa penguraian cahaya putih menjadi berbagai warna (dispersi) ditunjukkan oleh peristiwa ....", options: { a: optSvgs.q18a, b: optSvgs.q18b, c: optSvgs.q18c, d: optSvgs.q18d }, correct: "d" },
            { id: 19, text: "Cahaya dapat masuk melalui celah-celah jendela. Hal ini menunjukkan bahwa cahaya memiliki sifat....", options: { a: "Merambat lurus", b: "Cahaya tampak", c: "Cahaya diuraikan", d: "Cahaya dipantulkan" }, correct: "a" },
            { id: 20, text: "Apabila kita mengamati objek menggunakan lup dengan mata berakomodasi maksimum, maka posisi objek yang benar adalah ...", options: { a: optSvgs.q20a, b: optSvgs.q20b, c: optSvgs.q20c, d: optSvgs.q20d }, correct: "b" }
        ];

        // --- DATA SOAL MENJODOHKAN (10 Soal Isian dari Gambar) ---
        const matchingData = [
            { id: "m1", question: "Waktu yang diperlukan benda untuk melakukan satu getaran penuh", answer: "Periode" },
            { id: "m2", question: "Getaran yang merambat", answer: "Gelombang" },
            { id: "m3", question: "Getaran yang arah getarannya tegak lurus terhadap arah rambat", answer: "Transversal" },
            { id: "m4", question: "Jarak antara dua puncak gelombang yang berurutan", answer: "Panjang gelombang" },
            { id: "m5", question: "Pemantulan yang terjadi karena sinar mengenai permukaan kasar", answer: "Pemantulan baur" },
            { id: "m6", question: "Semakin besar tegangan senar maka frekuensi bunyi akan semakin...", answer: "Besar / Tinggi" },
            { id: "m7", question: "Jenis frekuensi bunyi yang dapat didengar oleh kelelawar", answer: "Ultrasonik" },
            { id: "m8", question: "Peristiwa pembelokan arah berkas cahaya dari satu zat ke zat lain", answer: "Pembiasan" },
            { id: "m9", question: "Alat yang memanfaatkan sifat pemantulan cahaya", answer: "Cermin" },
            { id: "m10", question: "Bagian bola mata yang bening dan dapat tembus cahaya", answer: "Kornea" }
        ];
        
        // Pilihan jawaban untuk dropdown (Diambil dari Kunci Jawaban Isian)
        const matchingOptions = [
            "Periode",
            "Gelombang",
            "Transversal",
            "Panjang gelombang",
            "Pemantulan baur",
            "Besar / Tinggi",
            "Ultrasonik",
            "Pembiasan",
            "Cermin",
            "Kornea",
            "Audiosonik", // Pengecoh
            "Longitudinal" // Pengecoh
        ];

        // --- RENDER FUNCTIONS ---

        function renderPG() {
            const container = document.getElementById('questionsContainer');
            let html = '';

            pgQuestions.forEach((q, index) => {
                // Check if image or table exists
                const mediaContent = q.img ? `<div class="mb-4">${q.img}</div>` : (q.table ? `<div class="mb-4 overflow-x-auto">${q.table}</div>` : '');

                html += `
                <div class="glass-card rounded-2xl p-5 mb-4 border border-white/50" id="card-${q.id}">
                    <div class="flex items-start mb-4">
                        <span class="flex-shrink-0 w-8 h-8 bg-green-100 text-green-700 rounded-full flex items-center justify-center font-bold text-sm mr-3 border border-green-200">${index + 1}</span>
                        <div class="w-full">
                            <p class="text-gray-800 font-medium text-lg leading-relaxed mb-3">${q.text}</p>
                            ${mediaContent}
                        </div>
                    </div>
                    <div class="space-y-3 pl-0 md:pl-11">
                        ${['a', 'b', 'c', 'd'].map(opt => `
                            <label class="option-label block relative group">
                                <input type="radio" name="q${q.id}" value="${opt}" class="option-input peer absolute opacity-0">
                                <div class="option-content bg-white/60 hover:bg-white border-2 border-transparent p-3 rounded-xl flex items-center text-gray-600 transition-all shadow-sm peer-checked:shadow-md">
                                    <span class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center text-xs font-bold mr-3 bg-gray-50 peer-checked:bg-green-500 peer-checked:text-white peer-checked:border-green-500 transition-colors uppercase">${opt}</span>
                                    <span class="flex-grow text-sm md:text-base w-full">${q.options[opt]}</span>
                                    <i class="check-icon fa-solid fa-circle-check text-green-600 text-xl ml-2 opacity-0 transform scale-0 transition-all duration-300"></i>
                                </div>
                            </label>
                        `).join('')}
                    </div>
                </div>
                `;
            });
            container.innerHTML = html;
        }

        function renderMatching() {
            const container = document.getElementById('matchingContainer');
            let html = '';

            // Sort options alphabetically for better UX
            const optionsHtml = matchingOptions.sort().map(opt => `<option value="${opt}">${opt}</option>`).join('');

            matchingData.forEach((item, index) => {
                html += `
                <div class="glass-card rounded-2xl p-5 border border-white/50 flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div class="flex items-start md:w-2/3">
                        <span class="flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center font-bold text-sm mr-3 border border-blue-200">${index + 1}</span>
                        <p class="text-gray-800 font-medium pt-1">${item.question}</p>
                    </div>
                    <div class="w-full md:w-1/3">
                        <select name="match_${item.id}" class="w-full p-3 border border-gray-300 rounded-xl bg-white focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none cursor-pointer">
                            <option value="" disabled selected>-- Pilih Jawaban --</option>
                            ${optionsHtml}
                        </select>
                    </div>
                </div>
                `;
            });
            container.innerHTML = html;
        }

        // --- LOGIC: Start Button Handler ---
        document.getElementById('btnStart').addEventListener('click', function() {
            // Validasi Identitas
            const nama = document.getElementById('namaSiswa').value.trim();
            const kelas = document.getElementById('kelasSiswa').value;

            if (!nama || !kelas) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Identitas Belum Lengkap',
                    text: 'Mohon isi Nama Lengkap dan Kelas terlebih dahulu!',
                    confirmButtonColor: '#16a34a'
                });
                return;
            }

            // Lock Input & Hide Start Button
            document.getElementById('namaSiswa').disabled = true;
            document.getElementById('kelasSiswa').disabled = true;
            this.classList.add('hidden'); 

            // Show Exam Section with Animation
            const examSection = document.getElementById('examSection');
            examSection.classList.remove('hidden');
            examSection.classList.add('animate-fade-in');

            // Scroll to questions gently
            setTimeout(() => {
                examSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        });

        // Handle Form Submission
        document.getElementById('quizForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Re-validate
            const nama = document.getElementById('namaSiswa').value.trim();
            const kelas = document.getElementById('kelasSiswa').value;

            // Konfirmasi sebelum kirim
            Swal.fire({
                title: 'Kirim Jawaban?',
                text: "Pastikan semua jawaban sudah terisi. Anda akan langsung mengetahui nilai Anda.",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#2563eb', // Blue
                cancelButtonColor: '#9ca3af',
                confirmButtonText: 'Ya, Kirim!',
                cancelButtonText: 'Cek Lagi'
            }).then((result) => {
                if (result.isConfirmed) {
                    processSubmission(nama, kelas);
                }
            });
        });

        function processSubmission(nama, kelas) {
            let totalScore = 0;
            const formData = new FormData(document.getElementById('quizForm'));

            // 1. Hitung Nilai PG (Bobot 3 poin per soal -> 20x3 = 60 poin)
            pgQuestions.forEach(q => {
                const userAns = formData.get(`q${q.id}`);
                if (userAns === q.correct) {
                    totalScore += 3;
                }
            });

            // 2. Hitung Nilai Menjodohkan (Bobot 4 poin per soal -> 10x4 = 40 poin)
            matchingData.forEach(m => {
                const userAns = formData.get(`match_${m.id}`);
                // Simple string matching (case insensitive)
                if (userAns && userAns.toLowerCase() === m.answer.toLowerCase()) {
                    totalScore += 4;
                }
            });

            // Tampilkan Loading
            Swal.fire({
                title: 'Mengirim Jawaban...',
                text: 'Mohon tunggu, sedang memproses nilai.',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            // URL Target
            const targetBaseUrl = "https://mtsn6-demak.github.io/nilai-siswa/";
            
            // UPDATE: Menambahkan parameter materi secara eksplisit
            const materiValue = "Formatif : Getaran, Gelombang, dan Cahaya";
            
            const targetUrl = `${targetBaseUrl}?name=${encodeURIComponent(nama)}&score=${totalScore}&kelas=${encodeURIComponent(kelas)}&materi=${encodeURIComponent(materiValue)}&type=Uji Kompetensi IPA&date=${encodeURIComponent(new Date().toLocaleDateString('id-ID'))}`;
            
            // Redirect
            setTimeout(() => {
                try {
                    window.location.href = targetUrl;
                } catch (error) {
                    console.error("Redirect Error:", error);
                    Swal.fire({
                        icon: 'success',
                        title: 'Selesai!',
                        html: `Terima kasih <b>${nama}</b>.<br>Nilai Anda: <b>${totalScore}</b>.<br><br><a href="${targetUrl}" target="_blank" class="text-blue-600 underline">Klik di sini jika tidak otomatis dialihkan</a>`
                    });
                }
            }, 1500);
        }

        // Initialize Render
        renderPG();
        renderMatching();

    </script>
</body>
</html>
